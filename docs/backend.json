{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the AuraGroove V2 application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user.",
          "format": "uuid"
        },
        "username": {
          "type": "string",
          "description": "The user's username."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "creationDate": {
          "type": "string",
          "description": "The date and time when the user account was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "username",
        "email",
        "creationDate"
      ]
    },
    "Masterpiece": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Masterpiece",
      "type": "object",
      "description": "Represents a successful musical configuration (DNA) saved for future breeding.",
      "properties": {
        "seed": {
          "type": "number",
          "description": "The random seed that generated this piece."
        },
        "mood": {
          "type": "string",
          "description": "The mood of the piece."
        },
        "genre": {
          "type": "string",
          "description": "The genre of the piece."
        },
        "density": {
          "type": "number",
          "description": "Note density parameter."
        },
        "bpm": {
          "type": "number",
          "description": "Beats per minute."
        },
        "instrumentSettings": {
          "type": "object",
          "description": "Snapshot of instrument configuration."
        },
        "timestamp": {
          "type": "string",
          "description": "Server timestamp of creation.",
          "format": "date-time"
        }
      },
      "required": [
        "seed",
        "mood",
        "genre",
        "timestamp"
      ]
    },
    "ContentIdea": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContentIdea",
      "type": "object",
      "description": "Represents a content idea generated by the AI model.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the content idea.",
          "format": "uuid"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who generated this content idea. (Relationship: User 1:N ContentIdea)"
        },
        "prompt": {
          "type": "string",
          "description": "The prompt used to generate the content idea."
        },
        "generatedText": {
          "type": "string",
          "description": "The text generated by the AI model."
        },
        "creationDate": {
          "type": "string",
          "description": "The date and time when the content idea was generated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "prompt",
        "generatedText",
        "creationDate"
      ]
    },
    "Canvas": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Canvas",
      "type": "object",
      "description": "Represents a canvas created and edited by the user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the canvas.",
          "format": "uuid"
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who owns this canvas. (Relationship: User 1:N Canvas)"
        },
        "name": {
          "type": "string",
          "description": "The name of the canvas."
        },
        "creationDate": {
          "type": "string",
          "description": "The date and time when the canvas was created.",
          "format": "date-time"
        },
        "lastModifiedDate": {
          "type": "string",
          "description": "The date and time when the canvas was last modified.",
          "format": "date-time"
        },
        "canvasData": {
          "type": "string",
          "description": "JSON data representing the canvas content (text, images, shapes)."
        }
      },
      "required": [
        "id",
        "userId",
        "name",
        "creationDate",
        "lastModifiedDate",
        "canvasData"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/masterpieces/{id}",
        "definition": {
          "entityName": "Masterpiece",
          "schema": {
            "$ref": "#/backend/entities/Masterpiece"
          },
          "description": "Global pool of successful musical DNAs. Readable by all, writable by authenticated users."
        }
      },
      {
        "path": "/users/{userId}/contentIdeas/{contentIdeaId}",
        "definition": {
          "entityName": "ContentIdea",
          "schema": {
            "$ref": "#/backend/entities/ContentIdea"
          },
          "description": "Stores content ideas generated by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "contentIdeaId",
              "description": "The unique identifier of the content idea."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/canvases/{canvasId}",
        "definition": {
          "entityName": "Canvas",
          "schema": {
            "$ref": "#/backend/entities/Canvas"
          },
          "description": "Stores canvases created by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "canvasId",
              "description": "The unique identifier of the canvas."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is updated to support global genetic memory via the 'masterpieces' collection. This collection is intentionally global to allow 'breeding' between different users' successful sessions, while maintaining strict private ownership for other user data."
  }
}
