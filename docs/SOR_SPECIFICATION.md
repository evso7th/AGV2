
# Техническая Спецификация: СОР (Система Обеспечения Разнообразия) v2.10

## 1. Концепция
СОР — это многоуровневая когнитивная надстройка над FractalMusicEngine, превращающая алгоритмическую генерацию в осмысленное музыкальное повествование. Система имитирует работу живого ансамбля, где каждый участник обладает памятью, слышит коллег и подчиняется драматическому сюжету.

---

## 2. Ключевые Технологии v2.10

### 2.1. Melodic Narration (Музыкальное Предложение)
*   **Механика**: Использование длинных музыкальных фраз (2-4 такта) в качестве атомарных единиц мелодии.
*   **Дыхание**: Логика "Вдоха" (soloistBusyUntilBar) — обязательные паузы между высказываниями.
*   **Exhale Dynamics**: Автоматическое снижение веса нот (`breathDecay`) к концу длинной фразы.

### 2.2. Spectral Hygiene (Анти-пчела)
*   **Алгоритм**: Динамическое управление LPF Cutoff в реальном времени.
*   **Логика**: Срез фильтра (800 - 5300 Гц) жестко связан с параметром `Fog` (Туман). Устраняет ВЧ-зуд в пресетах.

### 2.3. Narrative Bass (Теневой Контрапункт)
*   **Синхронизация**: Бас отслеживает текущую тему солиста.
*   **Исполнение**: Бас играет упрощенный контур мелодии в суб-басовом регистре, становясь "гармонической тенью".

### 2.4. Vital Heartbeat (Биологический Пульс)
*   **Механика**: Замена циклического метронома на биение сердца (Kick + Low Tom).
*   **Энергетика**: Частота и структура пульса динамически управляются уровнем Tension.

### 2.5. Nostalgic Comfort (v2.10)
*   **The Budd Dynasty**: Интеграция оцифрованных фортепианных фраз Harold Budd для меланхоличных режимов.
*   **Register Discipline**: Жесткое ограничение верхнего регистра мелодии уровнем MIDI 75 для сохранения мягкости саунда.
*   **Dorian Skeleton**: Использование Дорийского лада как основы для совмещения грусти и надежды.

---

## 3. Ревизия Функций по Уровням

### Уровень 4: СОЧИНЕНИЕ (The Mind of SOR)
*   **The Chain of Suites**: Циклическая ротация MAIN -> BRIDGE -> PROMENADE.
*   **Diabolus in Musica**: Впрыск тритона (+6) в Dark-режимах.
*   **Limbic Surge**: Акцент на малую сексту (+8) в минорных пиках.
*   **Flute Quarantine**: Блокировка инструмента "flute" и замена на "violin".

### Уровень 5: ТРАНСЛЯЦИЯ (Transmission)
*   **Harmony Audit**: Детальное логирование пути ноты.
*   **BPM Sync**: Динамическая подстройка плотности под темп.

### Уровень 7: ИСПОЛНЕНИЕ (Execution)
*   **Imperial Percussion**: Использование Sonor Classix и резонансных киков.
*   **Organic Detail Layer**: 15 независимых перкуссионных слоев, реагирующих на туман.
*   **Imperial Balance**: Автоматические дефолты громкости (55/50/15/35) для Амбиента.

---
**Статус**: Система достигла стандарта "Nostalgic Morning". Звучание глубокое, чистое и эмоционально богатое.
