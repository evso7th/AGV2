
# AuraGroove V2: Архитектурный Паспорт (Версия "Luminous Radiance")

Этот документ описывает финальную, эталонную архитектуру V2-движка, обеспечивающую абсолютную стабильность и чистоту звука после серии "Амбиентных Упражнений".

### 1. Ключевые Файлы

1.  **`src/app/ambient.worker.ts`**: **Композитор**. Генерирует ДНК и управляет бесконечным потоком MAIN сюит.
2.  **`src/lib/ambient-brain.ts`**: **Мозг СОР**. Управляет Атласами (География/Свет) и нарративной логикой.
3.  **`src/lib/instrument-factory.ts`**: **Стальной Фундамент**. Физический синтез и Global Voice Registry.

---

### 2. Принцип "Steel Foundation" (Ресурсная Безопасность)

Это ядро нашей победы над браузерным троттлингов и крахами в фоновом режиме.

#### 2.1. Басовая Чистота (The G1 Standard)
Мы установили жесткий нижний порог баса на уровне **MIDI 31 (G1)**.
*   Это устраняет фазовые искажения и "пердение" на сверхнизких частотах.
*   Длительности басовых нот ограничены ритмическим шагом, что исключает накопление инфразвукового гула.

#### 2.2. Global Voice Registry & Stealing
*   Лимит активных голосов поднят до **150** для поддержки длинных амбиентных релизов.
*   Voice Stealing гарантирует выживание контекста при любой плотности аранжировки.

---

### 3. Нарративная Архитектура

Система отошла от процедурных циклов к музыкальному повествованию.
*   **Piece-after-Piece**: Музыкальный опыт теперь непрерывен. BRIDGE и PROMENADE удалены. Каждая сюита — это новая MAIN картина с уникальным Seed.
*   **Narrative Bass**: В светлых режимах бас исполняет полноценные 2-4 тактовые фразы, которые эволюционируют, имитируя живого исполнителя.
*   **Shadow Harmony**: Гармонический слой (скрипки/гитара) работает в режиме "редких теней", подчеркивая энергетику Tension.

---

### 4. Йога Звука (Yoga of Radiance)

Реализована трехступенчатая модель восприятия для позитивных настроений:
1.  **Epic (Mixolydian)**: Масштаб и величие (Vangelis style).
2.  **Enthusiastic (Lydian)**: Полет и вибрация энергии (Jarre style).
3.  **Joyful (Ionian)**: Кристальная ясность и покой (Budd style).

---

### 5. The Stream Bridge (Background Sovereignty)

Режим **Broadcast (Radio)** обеспечивает абсолютную стабильность воспроизведения.
*   **Direct Routing**: MediaStream -> HTMLAudioElement.srcObject.
*   **Silk Start**: Плавный fade-in на уровне элемента для маскировки шумов буферизации.
*   **OS Priority**: Статус медиа-плеера предотвращает засыпание вкладки.
