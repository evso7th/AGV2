
# Журнал Проекта "AuraGroove"

---

### ЗАПИСЬ: 2024-12-04 (План №219: «NON-FINITE AUDIOPARAM CRITICAL FIX»)

**ПРОБЛЕМА:**
Критический сбой `Uncaught (in promise) TypeError: Failed to execute 'linearRampToValueAtTime' on 'AudioParam': The provided double value is non-finite`.

**ПРИЧИНА:**
В файле `instrument-factory.ts` отсутствовали проверки на конечность чисел (`isFinite`) для параметров ADSR. При использовании пресетов с неполными объектами `adsr` переменные атаки, спада или релиза принимали значение `NaN`, что недопустимо для Web Audio API.

**РЕШЕНИЕ:**
1. В `src/lib/instrument-factory.ts` проведена ревизия функций `triggerAttack` и `triggerRelease`.
2. Внедрены тотальные проверки `isFinite` для всех временных меток и уровней громкости.
3. Добавлены безопасные значения по умолчанию (fallback) для каждого этапа огибающей.
4. Процедура "Core Freeze" была временно снята пользователем для этой операции.

**ВЫВОД:**
Стабильность аудио-движка восстановлена. Система теперь устойчива к любым неполным или некорректным данным в пресетах инструментов.

---

### ЗАПИСЬ: 2024-12-04 (План №218: «SEMANTIC SEEDING & LICK ROTATION»)

**ПРОБЛЕМА:**
Необходимость повышения уникальности и семантической осмысленности каждой новой сессии "Dark Blues".

**ПРИЧИНА:**
Ранее первая мелодическая фраза генерировалась полностью случайно, что лишало сюиту тематического «якоря» в самом начале.

**РЕШЕНИЕ:**
1. В `SuiteDNA` введено поле `seedLickId`.
2. В `music-theory.ts` внедрен механизм **Lick Rotation**:
    *   Создан статический реестр `LICK_HISTORY` (память на 10 последних сессий).
    *   Для каждой новой сюиты выбирается уникальный лик из библиотеки (с тегом `minor`), которого не было в истории.
3. В `BluesBrain` метод `generateInitialAxiom` переписан на использование `seedLickId`. Теперь лик из библиотеки служит «генетическим семенем» (Уровнем 0), от которого растут все фрактальные ветви мелодии.

**ВЫВОД:**
Теперь каждая сессия Dark Blues начинается с уникальной, узнаваемой темы, которая детерминированно развивается на протяжении 15 минут, обеспечивая баланс между новизной и тематической связностью.

---
