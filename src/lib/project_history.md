
# Журнал Проекта "AuraGroove"

---

### ЗАПИСЬ: 2024-12-04 (План №199: «ENSEMBLE BALANCE & KEYBOARD CEILING»)

**ПРОБЛЕМА:**
Пианино в верхнем регистре конфликтует с гитарой, а избыточная громкость гитары Shine On подавляет глубину пэдов и общую атмосферу.

**ПРИЧИНА:**
Отсутствие регистрового лимита для вспомогательных инструментов и несбалансированные уровни в пресетах V2.

**РЕШЕНИЕ:**
1. Для пианино (`generatePianoMotif`) применен регистровый потолок MIDI 79 (G5), синхронно с гитарой.
2. Громкость пресета `guitar_shineOn` снижена в 3 раза (с 0.68 до 0.23) для достижения аутентичного "floydian" баланса.
3. Прозрачность микса значительно улучшена.

**ВЫВОД:**
Ансамбль обрел правильную иерархию: пэды создают фундамент, а гитара и пианино деликатно дополняют его, не перегружая спектр.

---

### ЗАПИСЬ: 2024-12-04 (План №197: «REGISTER CEILING — 5TH OCTAVE LIMIT»)

**ПРОБЛЕМА:**
Гитара на высоких нотах (выше G5) звучит неестественно, обретая «комариный» цифровой оттенок, что разрушает иллюзию живого инструмента.

**ПРИЧИНА:**
Выход за пределы оптимального диапазона донорских транзиентов и физических ограничений эмулируемого корпуса.

**РЕШЕНИЕ:**
1. В BluesBrain внедрена константа `MELODY_CEILING = 79` (G5).
2. Все методы генерации мелодии (`generateLSystemMelody`, `generateFingerstyleMelody`) теперь используют `Math.min(note, 79)`.
3. Защита от похоронного марша также ограничена этим потолком.

**ВЫВОД:**
Соло-партии стали более весомыми и стилистически выверенными в духе Гилмора.

---

### ЗАПИСЬ: 2024-12-04 (План №196: «START-BEFORE-STOP FIX»)

**ПРОБЛЕМА:**
Крах аудио-планировщика с ошибкой `InvalidStateError: cannot call stop without calling start first`. Отсутствие логов GVR.

**ПРИЧИНА:**
В гибридном режиме сэмплера Telecaster команда `source.stop()` вызывалась раньше `source.start()`, что нарушает требования Web Audio API.

**РЕШЕНИЕ:**
1. Изменен порядок команд в `playSample`: теперь `source.start()` вызывается первым, подготавливая ноду к приему команды `source.stop()`.
2. Подтверждена работа системного события `onended` для корректной очистки GVR.

**ВЫВОД:**
Стабильность гибридного синтеза восстановлена. Логи GVR должны вернуться в штатный режим.

---

### ЗАПИСЬ: 2024-12-04 (План №195: «HYBRID TRANSIENT DONORS»)

**ПРОБЛЕМА:**
Синтезаторные гитары (Shine On, Muff Lead) звучат недостаточно убедительно из-за синтетической атаки, несмотря на сложную структуру корпуса.

**ПРИЧИНА:**
Шумовой транзиент в замороженной фабрике является математическим приближением, лишенным хаотических обертонов реального удара медиатора по струне.

**РЕШЕНИЕ:**
1. **Donor Mode**: В сэмплер Telecaster добавлен режим извлечения транзиента. Сэмпл обрезается на отметке **20 мс** с использованием "алгоритмической хирургии" (быстрый фейдаут).
2. **Hybrid Trigger**: Менеджер `MelodySynthManagerV2` теперь работает в двухпоточном режиме: при вызове `guitar_shineOn` он одновременно запускает синтетический "корпус" из фабрики и реальный "щипок" из сэмплера Telecaster.
3. **Resource Alignment**: Использование существующих сыгранных нот как доноров вместо открытых струн позволило избежать лишнего питч-шифтинга и сохранило физику резонанса на разных ладах.

**ВЫВОД:**
Достигнут новый уровень реализма электрогитары без нарушения протокола "Заморозки Ядра".

---

### ЗАПИСЬ: 2024-12-04 (План №194: «CORE FREEZE & TRANSIENT STANDARD»)

**СТАТУС: ВВЕДЕН КАТЕГОРИЧЕСКИЙ ЗАПРЕТ НА МОДИФИКАЦИЮ ЯДРА (CORE FREEZE). ФАБРИКА ЗАКРЫТА НА ТРИ ЗАМКА.**

**ВЫВОДЫ ИССЛЕДОВАНИЯ:**
1. **Transient Standard**: Установлено, что оптимальная длительность транзиента для гибридного синтеза — первые **20 мс** волны. Это зона хаотической энергии, удара и резонанса, которая дает 90% эффекта "реальности" при наложении на синтетический тон.
2. **Architecture Lock**: Код `src/lib/instrument-factory.ts` зафиксирован как стабильный и производительный. Дальнейшее развитие системы переносится в область когнитивной композиции (Brain) и настройки пресетов.

---
