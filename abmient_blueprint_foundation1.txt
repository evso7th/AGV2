–∏ —Ç–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–µ–º –±–ª—é–ø—Ä–∏–Ω—Ç—ã –ø–æ–¥ –∫–∞–∂–¥–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∞–º–±–∏–µ–Ω—Ç–∞. —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –º—É–∑—ã–∫–∞ —Å–∏–Ω—Ç–µ–∑–∞—Ç–æ—Ä–∞ –∞–∫–∫–æ–º–ø–∞–Ω–∏–º–µ–Ω—Ç–∞ –≤ –ø–∞—Ä–µ —Å –±–∞—Å–æ–º. –ø–ª–∞–≤–Ω–æ–µ –∏–Ω—Ç—Ä–æ —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º –≤–∫–ª—é—á–µ–Ω–∏–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ç—Ä–æ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω—Ç—Ä–æ - –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç bpm. –ß–µ–º –≤—ã—à–µ bpm, —Ç–µ–º –≤—Å–µ –∫–æ—Ä–æ—á–µ. —É–¥–∞—Ä–Ω—ã–µ - –ø–µ—Ä–∫—É—Å—Å–∏–∏, –Ω–µ–º–Ω–æ–≥–æ —Ç–æ–º—ã –∏ —Ä–∞–π–¥—ã. —Å—ç–º–ø–ª—ã –ø—ç–¥–æ–≤ (sparkles) –∏ sfx –≤ –∏–Ω—Ç—Ä–æ –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç. –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–¥–Ω–æ–π —Å—å—é–∏—Ç—ã - 10-15 –º–∏–Ω—É—Ç, —Ç–µ—Ö–Ω–∏–∫–∞ –∏–≥—Ä—ã - —Ñ—Ä–∞–∑—ã, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –≤ –±–∞–Ω–¥–ª—ã, –±–∞–Ω–¥–ª—ã –æ–±—å–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ —á–∞—Å—Ç–∏, —á–∞—Å—Ç–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ —Å—å—é–∏—Ç—É. –º–∏–∫—Ä–æ–º—É—Ç–∞—Ü–∏–∏ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –±–∞–Ω–¥–ª–æ–≤, —Å—Ä–µ–¥–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö —á–∞—Å—Ç–µ–π, –≥–ª–æ–±–Ω–∞—è –º—É—Ç–∞—Ü–∏—è –Ω–æ–≤—ã–µ –∞–∫—Å–∏–æ–º—ã - –Ω–æ–≤–∞—è —Å—å–±–∏—Ç–∞. –Ω—É—Ö–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ —Ñ–∏–ª–ª—ã –º–µ–∂–¥—É –±–∞–Ω–¥–ª–∞–º–∏, —á–∞—Å—Ç—è–º–∏ –∏ —Å—å—é–∏—Ç–∞–º–∏. –ü–æ–∫—Ä–∏—Ç–∏–∫—É–π—Ç–µ, –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —Å–æ–∏ –∏–¥–µ–∏, –µ—Å–ª–∏ –º–æ–∏ –ø–ª–æ—Ö–∏–µ. —Å–Ω–∞—á–∞–ª–∞ –æ–±—Å—É–¥–∏–º –ø—Ä–∏–Ω—Ü–∏–ø—ã, –ø–æ—Ç–æ–º –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å –±–ª—é–ø—Ä–∏–Ω—Ç—ã. –±–ª—é–ø—Ä–∏–Ω—Ç - –Ω–µ —à–∞–±–ª–æ–Ω, –∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º—ã—â–ª–µ–Ω–∏–π –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä–∞. –∫–∞–∂–¥–∞—è —Å—å—é–∏—Ç–∞ –¥–∞–∂–µ –ø–æ –æ–¥–Ω–æ–º—É –±–ª—é–ø—Ä–∏–Ω—Ç—É - —É–Ω–∏–∫–∞–ª—å–Ω–∞ –∏ –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º–∞.


# –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó –ö–û–ù–¶–ï–ü–¶–ò–ò –ë–õ–Æ–ü–†–ò–ù–¢–û–í

---

## –û–¶–ï–ù–ö–ê –í–ê–®–ò–• –ò–î–ï–ô

### ‚úÖ –°–ò–õ–¨–ù–´–ï –°–¢–û–†–û–ù–´ (—á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ)

#### 1. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ "–§—Ä–∞–∑–∞ ‚Üí –ë–∞–Ω–¥–ª ‚Üí –ß–∞—Å—Ç—å ‚Üí –°—é–∏—Ç–∞"
**–ü–æ—á–µ–º—É —Ö–æ—Ä–æ—à–æ:**
- –≠—Ç–æ **–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –º—É–∑—ã–∫–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞** (–∞–Ω–∞–ª–æ–≥: –º–æ—Ç–∏–≤ ‚Üí —Ñ—Ä–∞–∑–∞ ‚Üí –ø–µ—Ä–∏–æ–¥ ‚Üí —Ñ–æ—Ä–º–∞).
- –î–∞—ë—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞ –≤—Å–µ—Ö –º–∞—Å—à—Ç–∞–±–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å (—É–∑–Ω–∞–≤–∞–µ–º–æ—Å—Ç—å) –∏ –Ω–æ–≤–∏–∑–Ω—É.

**–ú–æ–π –≤–∫–ª–∞–¥:**
–ü—Ä–µ–¥–ª–∞–≥–∞—é **—è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è:
```
–§—Ä–∞–∑–∞:  4-8 —Ç–∞–∫—Ç–æ–≤   (–±–∞–∑–æ–≤–∞—è –º—É–∑—ã–∫–∞–ª—å–Ω–∞—è –º—ã—Å–ª—å)
–ë–∞–Ω–¥–ª:  16-32 —Ç–∞–∫—Ç–∞  (3-5 —Ñ—Ä–∞–∑, ~1-2 –º–∏–Ω—É—Ç—ã @ 52 BPM)
–ß–∞—Å—Ç—å:  48-96 —Ç–∞–∫—Ç–æ–≤ (2-4 –±–∞–Ω–¥–ª–∞, ~3-5 –º–∏–Ω—É—Ç)
–°—é–∏—Ç–∞:  200-300 —Ç–∞–∫—Ç–æ–≤ (3-5 —á–∞—Å—Ç–µ–π, 10-15 –º–∏–Ω—É—Ç)
```

–≠—Ç–æ –¥–∞—ë—Ç **–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é, –Ω–æ –≥–∏–±–∫—É—é —Å–µ—Ç–∫—É**.

---

#### 2. –ì—Ä–∞–¥–∞—Ü–∏—è –º—É—Ç–∞—Ü–∏–π –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏
**–ü–æ—á–µ–º—É —Ö–æ—Ä–æ—à–æ:**
- –ú–∏–∫—Ä–æ–º—É—Ç–∞—Ü–∏–∏ (—Ç—Ä–∞–Ω—Å–ø–æ–∑–∏—Ü–∏—è ¬±2 –ø–æ–ª—É—Ç–æ–Ω–∞, rhythmic shift) –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –±–∞–Ω–¥–ª–æ–≤ ‚Äî —ç—Ç–æ **–ø–ª–∞–≤–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ**.
- –°—Ä–µ–¥–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏ (–Ω–æ–≤—ã–π –≤–æ–∏—Å–∏–Ω–≥, –∏–Ω–≤–µ—Ä—Å–∏—è, —Å–º–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞) –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö —á–∞—Å—Ç–µ–π ‚Äî —ç—Ç–æ **–æ—â—É—Ç–∏–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**.
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ (–Ω–æ–≤—ã–µ –∞–∫—Å–∏–æ–º—ã) ‚Äî —ç—Ç–æ **–¥—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥**, –Ω–æ–≤–∞—è –≥–ª–∞–≤–∞.

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
‚ö†Ô∏è –†–∏—Å–∫ **—Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π** ‚Üí –º—É–∑—ã–∫–∞ —Å—Ç–∞–Ω–µ—Ç –Ω–µ—Ä–≤–Ω–æ–π, –Ω–µ ambient.

**–†–µ—à–µ–Ω–∏–µ:**
–í–≤–µ—Å—Ç–∏ **–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º—É—Ç–∞—Ü–∏–∏**, –∑–∞–≤–∏—Å—è—â—É—é –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è:
```typescript
type MutationPolicy = {
  onBundleBoundary: {
    probability: number;  // 0..1
    types: MutationType[]; // ['transpose', 'rhythmic_shift']
  };
  onPartBoundary: {
    probability: number;
    types: MutationType[];
  };
};

const MOOD_MUTATION_POLICIES = {
  dark: {
    onBundleBoundary: { probability: 0.3, types: ['transpose'] }, // –†–µ–¥–∫–æ, —Å—Ç–∞—Ç–∏—á–Ω–æ
    onPartBoundary: { probability: 0.6, types: ['inversion', 'register_shift'] }
  },
  joyful: {
    onBundleBoundary: { probability: 0.7, types: ['transpose', 'rhythmic_shift'] }, // –ß–∞—Å—Ç–æ, –∂–∏–≤–æ
    onPartBoundary: { probability: 0.9, types: ['retrograde', 'augmentation'] }
  }
};
```

–¢–∞–∫ `dark` ambient –±—É–¥–µ—Ç –±–æ–ª–µ–µ **–º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω—ã–º** (–¥–æ–ª–≥–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –æ–¥–Ω—É –∏–¥–µ—é), –∞ `joyful` ‚Äî **–∏–≥—Ä–∏–≤—ã–º** (—á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è).

---

#### 3. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–Ω—Ç—Ä–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ BPM
**–ü–æ—á–µ–º—É —Ö–æ—Ä–æ—à–æ:**
- **–õ–æ–≥–∏—á–Ω–æ**: –º–µ–¥–ª–µ–Ω–Ω—ã–π ambient (40 BPM) –º–æ–∂–µ—Ç –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ 2-–º–∏–Ω—É—Ç–Ω–æ–µ –∏–Ω—Ç—Ä–æ, –±—ã—Å—Ç—Ä—ã–π (70 BPM) ‚Äî –Ω–µ—Ç.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –±–µ–∑ —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

**–§–æ—Ä–º—É–ª–∞:**
```typescript
function calculateIntroDuration(bpm: number): number {
  // –ë–∞–∑–æ–≤–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 90 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ 52 BPM
  const baseDuration = 90; // —Å–µ–∫—É–Ω–¥
  const baseBPM = 52;
  
  // –û–±—Ä–∞—Ç–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ BPM
  const duration = baseDuration * (baseBPM / bpm);
  
  // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º: –Ω–µ –∫–æ—Ä–æ—á–µ 30 —Å–µ–∫, –Ω–µ –¥–ª–∏–Ω–Ω–µ–µ 180 —Å–µ–∫
  return Math.max(30, Math.min(180, duration));
}

// –ü—Ä–∏–º–µ—Ä—ã:
// BPM 40  ‚Üí 117 —Å–µ–∫ (–ø–æ—á—Ç–∏ 2 –º–∏–Ω—É—Ç—ã) ‚úÖ
// BPM 52  ‚Üí 90 —Å–µ–∫
// BPM 70  ‚Üí 67 —Å–µ–∫
// BPM 100 ‚Üí 47 —Å–µ–∫
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**
```typescript
function getInstrumentEntrySchedule(introDuration: number): {
  bass: number;        // —Å–µ–∫—É–Ω–¥ –æ—Ç –Ω–∞—á–∞–ª–∞
  accompaniment: number;
  drums: number;
  sparkles: number;
} {
  return {
    bass: 0,                          // –°—Ä–∞–∑—É
    accompaniment: introDuration * 0.25, // 25% –∏–Ω—Ç—Ä–æ
    drums: introDuration * 0.75,      // 75% –∏–Ω—Ç—Ä–æ (–ø–æ–∑–∂–µ!)
    sparkles: introDuration * 1.0     // –ö–æ–Ω–µ—Ü –∏–Ω—Ç—Ä–æ = –Ω–∞—á–∞–ª–æ BUILD
  };
}
```

---

#### 4. –§–∏–ª–ª—ã –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö
**–ü–æ—á–µ–º—É —Ö–æ—Ä–æ—à–æ:**
- –≠—Ç–æ **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä–∞–Ω–∂–∏—Ä–æ–≤–∫–∞** (–∫–∞–∫ –≤ –∂–∏–≤–æ–π –º—É–∑—ã–∫–µ).
- –§–∏–ª–ª —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–ª—É—à–∞—Ç–µ–ª—é: "–≤–Ω–∏–º–∞–Ω–∏–µ, —Å–µ–π—á–∞—Å —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è".

**–¢–∏–ø—ã —Ñ–∏–ª–ª–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—é:**
```typescript
type FillType = 'micro' | 'medium' | 'macro';

const FILL_SPECS = {
  micro: {  // –ú–µ–∂–¥—É –±–∞–Ω–¥–ª–∞–º–∏
    duration: 1,           // —Ç–∞–∫—Ç
    instruments: ['drums'], // –¢–æ–ª—å–∫–æ –ø–µ—Ä–∫—É—Å—Å–∏—è
    technique: 'roll'      // –ë–∞—Ä–∞–±–∞–Ω–Ω–∞—è –¥—Ä–æ–±—å
  },
  medium: { // –ú–µ–∂–¥—É —á–∞—Å—Ç—è–º–∏
    duration: 2,
    instruments: ['drums', 'bass'],
    technique: 'crescendo' // –ù–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ
  },
  macro: {  // –ú–µ–∂–¥—É —Å—é–∏—Ç–∞–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    duration: 4,
    instruments: ['all'],
    technique: 'diminuendo_pause' // –ó–∞—Ç—É—Ö–∞–Ω–∏–µ + –ø–∞—É–∑–∞
  }
};
```

**–ö—Ä–∏—Ç–∏–∫–∞:**
‚ö†Ô∏è **–§–∏–ª–ª—ã –º–æ–≥—É—Ç –Ω–∞—Ä—É—à–∏—Ç—å "–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å"**, –µ—Å–ª–∏ –±—É–¥—É—Ç —Å–ª–∏—à–∫–æ–º —è–≤–Ω—ã–º–∏.

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è ambient:**
–ù–µ –±–∞—Ä–∞–±–∞–Ω–Ω—ã–µ —Ñ–∏–ª–ª—ã, –∞ **–≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–µ/—Ç–µ–∫—Å—Ç—É—Ä–Ω—ã–µ**:
```typescript
// –í–º–µ—Å—Ç–æ drum roll:
type AmbientFill = {
  technique: 'filter_sweep'    // LPF –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
           | 'reverb_swell'    // –†–µ–≤–µ—Ä–± —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
           | 'harmonic_shift'  // –ê–∫–∫–æ—Ä–¥ "—Å—ä–µ–∑–∂–∞–µ—Ç" –≤ –¥—Ä—É–≥—É—é —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
           | 'density_burst';  // –†–µ–∑–∫–æ–µ —É–ø–ª–æ—Ç–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –Ω–∞ 1 —Ç–∞–∫—Ç
};
```

–ü—Ä–∏–º–µ—Ä:
```
–ö–æ–Ω–µ—Ü –±–∞–Ω–¥–ª–∞ 1: Dm7 ‚Üí (filter sweep –≤–≤–µ—Ä—Ö) ‚Üí –ù–∞—á–∞–ª–æ –±–∞–Ω–¥–ª–∞ 2: Am7
```

–°–ª—É—à–∞—Ç–µ–ª—å —É—Å–ª—ã—à–∏—Ç "–ø–µ—Ä–µ—Ö–æ–¥", –Ω–æ –æ–Ω –±—É–¥–µ—Ç **–ø–ª–∞–≤–Ω—ã–º**, –Ω–µ —Ä–∞–∑—Ä—ã–≤–∞—é—â–∏–º –ø–æ—Ç–æ–∫.

---

### ‚ö†Ô∏è –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

#### –ü—Ä–æ–±–ª–µ–º–∞ 1: "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –º—É–∑—ã–∫–∞ –∞–∫–∫–æ–º–ø–∞–Ω–µ–º–µ–Ω—Ç–∞"
**–í–∞—à–∞ –∏–¥–µ—è:** –°–∏–Ω—Ç–µ–∑–∞—Ç–æ—Ä + –±–∞—Å –≤—Å–µ–≥–¥–∞ –∑–≤—É—á–∞—Ç.

**–†–∏—Å–∫:**
- Ambient **–Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ**. –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –∑–≤—É—á–∞–Ω–∏–µ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å "—Å—Ç–µ–Ω–æ–π –∑–≤—É–∫–∞".
- –°–ª—É—à–∞—Ç–µ–ª—å —É—Å—Ç–∞—ë—Ç –æ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–∞—É–∑.

**–ö–æ–Ω—Ç—Ä–ø—Ä–∏–º–µ—Ä (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ambient):**
Brian Eno "Music for Airports" ‚Äî —Ç–∞–º **–º–Ω–æ–≥–æ —Ç–∏—à–∏–Ω—ã**. –ù–æ—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ä–µ–¥–∫–æ, –∫–∞–∫ –∫–∞–ø–ª–∏ –≤–æ–¥—ã.

**–ö–æ–º–ø—Ä–æ–º–∏—Å—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
–ù–µ –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å, –∞ **—É–ø—Ä–∞–≤–ª—è–µ–º–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å**:
```typescript
type ContinuityPolicy = {
  bass: {
    minDensity: number;    // 0..1, —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–≤—É—á–∏—Ç
    maxGapDuration: number; // –ú–∞–∫—Å. –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞—É–∑—ã (—Ç–∞–∫—Ç–æ–≤)
  };
  accompaniment: {
    minDensity: number;
    maxGapDuration: number;
  };
};

const MOOD_CONTINUITY = {
  dark: {
    bass: { minDensity: 0.6, maxGapDuration: 4 },        // 60% –≤—Ä–µ–º–µ–Ω–∏, –ø–∞—É–∑—ã –¥–æ 4 —Ç–∞–∫—Ç–æ–≤
    accompaniment: { minDensity: 0.8, maxGapDuration: 2 } // 80% –≤—Ä–µ–º–µ–Ω–∏
  },
  dreamy: {
    bass: { minDensity: 0.4, maxGapDuration: 8 },        // –ë–æ–ª–µ–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–æ
    accompaniment: { minDensity: 0.5, maxGapDuration: 6 }
  }
};
```

**–ü—Ä–∞–≤–∏–ª–æ:**
- **Intro/Outro:** –º–æ–∂–Ω–æ –ø–∞—É–∑—ã –¥–æ 8 —Ç–∞–∫—Ç–æ–≤ (–º–µ–¥–∏—Ç–∞—Ü–∏—è).
- **Main:** –º–∏–Ω–∏–º—É–º 70% –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ (—ç–Ω–µ—Ä–≥–∏—è).
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –º–æ–ª—á–∞—Ç –æ–±–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** (–≤—Å–µ–≥–¥–∞ —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ –∑–≤—É—á–∏—Ç).

---

#### –ü—Ä–æ–±–ª–µ–º–∞ 2: –£–¥–∞—Ä–Ω—ã–µ "–Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –∏–Ω—Ç—Ä–æ"
**–í–∞—à–∞ –∏–¥–µ—è:** Drums –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ–∑–∂–µ.

**–°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ 100%** –¥–ª—è ambient. –ù–æ —É—Ç–æ—á–Ω–µ–Ω–∏–µ:

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–†–∞–∑–¥–µ–ª–∏—Ç—å —É–¥–∞—Ä–Ω—ã–µ –Ω–∞ **–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –≤—Ç–æ—Ä–∂–µ–Ω–∏—é**:
```typescript
type PercussionLayer = {
  name: string;
  entryPoint: 'intro' | 'build' | 'main'; // –ö–æ–≥–¥–∞ –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è
  density: number;
};

const PERCUSSION_LAYERS = {
  shaker: { 
    entryPoint: 'intro',  // –ú–æ–∂–µ—Ç –±—ã—Ç—å —É–∂–µ –≤ –∏–Ω—Ç—Ä–æ (–æ—á–µ–Ω—å —Ç–∏—Ö–æ)
    density: 0.2 
  },
  toms: { 
    entryPoint: 'build', 
    density: 0.3 
  },
  ride: { 
    entryPoint: 'build', 
    density: 0.4 
  },
  frame_drum: { 
    entryPoint: 'main', 
    density: 0.5 
  }
};
```

**–õ–æ–≥–∏–∫–∞:**
- **Intro:** –ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è —Ä–∏—Ç–º–∞ ‚Äî —Ç–æ–ª—å–∫–æ **texture percussion** (—à–µ–π–∫–µ—Ä, ocean drum) –Ω–∞ -30 dB, –ø–æ—á—Ç–∏ –Ω–µ —Å–ª—ã—à–Ω–æ.
- **Build:** –í—Ö–æ–¥—è—Ç **–º—è–≥–∫–∏–µ —É–¥–∞—Ä–Ω—ã–µ** (soft mallets, brushed toms).
- **Main:** –ü–æ–ª–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞.

---

#### –ü—Ä–æ–±–ª–µ–º–∞ 3: "–ë–ª—é–ø—Ä–∏–Ω—Ç ‚Äî –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π, –∞ –Ω–µ —à–∞–±–ª–æ–Ω"
**–í–∞—à–∞ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è:** –ö–∞–∂–¥–∞—è —Å—é–∏—Ç–∞ —É–Ω–∏–∫–∞–ª—å–Ω–∞ –¥–∞–∂–µ –ø–æ –æ–¥–Ω–æ–º—É –±–ª—é–ø—Ä–∏–Ω—Ç—É.

**–ê–±—Å–æ–ª—é—Ç–Ω–æ —Å–æ–≥–ª–∞—Å–µ–Ω!** –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç "–ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç–µ–ª—è —Ç—Ä–µ–∫–æ–≤".

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç—Ç–æ–π —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏:**
–ë–ª—é–ø—Ä–∏–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å **–Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∞ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏**:

```typescript
// ‚ùå –ü–õ–û–•–û (–∂—ë—Å—Ç–∫–∏–π —à–∞–±–ª–æ–Ω):
const blueprint = {
  intro: {
    duration: 16,  // –í—Å–µ–≥–¥–∞ 16 —Ç–∞–∫—Ç–æ–≤
    bassTechnique: 'pedal' // –í—Å–µ–≥–¥–∞ –ø–µ–¥–∞–ª—å
  }
};

// ‚úÖ –•–û–†–û–®–û (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ):
const blueprint = {
  intro: {
    durationRange: [12, 20],      // –û—Ç 12 –¥–æ 20 —Ç–∞–∫—Ç–æ–≤ (–≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ)
    bassTechniques: [
      { technique: 'pedal', weight: 0.7 },      // 70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
      { technique: 'drone', weight: 0.3 }       // 30% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
    ],
    densityRange: [0.2, 0.4],     // –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è
    registerBias: 'low'           // –û–±—â–∞—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è, –Ω–æ –Ω–µ –∑–∞–∫–æ–Ω
  }
};
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –î–≤–∞ –∑–∞–ø—É—Å–∫–∞ —Å `seed=42` ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏).
- –î–≤–∞ –∑–∞–ø—É—Å–∫–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ seed ‚Üí —Ä–∞–∑–Ω—ã–µ, –Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è".

---

### üîß –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ò–î–ï–ò

#### –ò–¥–µ—è 1: "–î—ã—Ö–∞–Ω–∏–µ" —Å—é–∏—Ç—ã (Macro Tension Curve)
–î–∞–∂–µ –ø—Ä–∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –Ω—É–∂–Ω–∞ **–æ–±—â–∞—è –¥—Ä–∞–º–∞—Ç—É—Ä–≥–∏—è**.

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ö–∞–∂–¥–∞—è —Å—é–∏—Ç–∞ –∏–º–µ–µ—Ç **tension profile**:
```typescript
type TensionProfile = 'arc' | 'plateau' | 'wave' | 'crescendo';

const TENSION_PROFILES = {
  arc: {
    // –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥—É–≥–∞: intro ‚Üí apex (60%) ‚Üí release
    curve: (progress: number) => {
      if (progress < 0.6) return Math.pow(progress / 0.6, 1.3);
      else return Math.pow((1 - progress) / 0.4, 2);
    }
  },
  plateau: {
    // –ù–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ ‚Üí –¥–æ–ª–≥–æ–µ –ø–ª–∞—Ç–æ ‚Üí —Ä–µ–∑–∫–∏–π —Å–ø–∞–¥
    curve: (progress: number) => {
      if (progress < 0.3) return progress / 0.3;
      if (progress < 0.8) return 1.0;
      else return (1 - progress) / 0.2;
    }
  },
  wave: {
    // –î–≤–µ –≤–æ–ª–Ω—ã (–¥–≤–∞ –ø–∏–∫–∞)
    curve: (progress: number) => {
      return 0.5 + 0.5 * Math.sin(progress * Math.PI * 2 - Math.PI / 2);
    }
  }
};

// –í –±–ª—é–ø—Ä–∏–Ω—Ç–µ:
const melancholicBlueprint = {
  tensionProfile: 'arc', // –î–ª—è –º–µ–ª–∞–Ω—Ö–æ–ª–∏–∏ ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥—É–≥–∞
  // ...
};
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
Tension –º–æ–¥—É–ª–∏—Ä—É–µ—Ç:
- –ü–ª–æ—Ç–Ω–æ—Å—Ç—å (density)
- –Ø—Ä–∫–æ—Å—Ç—å (filter cutoff)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–ª–æ—ë–≤
- –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º—É—Ç–∞—Ü–∏–π (–Ω–∞ –ø–∏–∫–µ tension ‚Äî –±–æ–ª—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

#### –ò–¥–µ—è 2: –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è —á–∞—Å—Ç–∏
–ö–∞–∂–¥–∞—è **–ß–∞—Å—Ç—å** (Part) –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ–π **–≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä —Ç—è–∂–µ—Å—Ç–∏**.

**–ü—Ä–∏–º–µ—Ä –¥–ª—è D Dorian:**
```typescript
const partHarmonicCenters = [
  { part: 1, center: 'Dm7', satellites: ['Gm7', 'Am7'] },      // –¢–æ–Ω–∏–∫–∞
  { part: 2, center: 'Gm7', satellites: ['Dm7', 'Cmaj7'] },    // –°—É–±–¥–æ–º–∏–Ω–∞–Ω—Ç–∞
  { part: 3, center: 'Am7', satellites: ['Dm7', 'Fmaj7'] },    // –î–æ–º–∏–Ω–∞–Ω—Ç–∞
  { part: 4, center: 'Dm7', satellites: ['Gm7', 'Am7'] }       // –í–æ–∑–≤—Ä–∞—Ç
];
```

**–õ–æ–≥–∏–∫–∞:**
- –í **–ß–∞—Å—Ç–∏ 1** –±–∞—Å –∏ –∞–∫–∫–æ–º–ø–∞–Ω–µ–º–µ–Ω—Ç –∫—Ä—É—Ç—è—Ç—Å—è –≤–æ–∫—Ä—É–≥ Dm7 (70% –≤—Ä–µ–º–µ–Ω–∏).
- –í **–ß–∞—Å—Ç–∏ 2** —Å–º–µ—â–∞–µ–º—Å—è –∫ Gm7 (–º–æ–¥—É–ª—è—Ü–∏—è –±–µ–∑ —Ä–µ–∑–∫–æ–≥–æ —Å–∫–∞—á–∫–∞).
- –í **–ß–∞—Å—Ç–∏ 4** –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –¥–æ–º–æ–π ‚Üí –æ—â—É—â–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

–≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç **–∫—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω–æ–µ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ —Å–ª—É—à–∞—Ç–µ–ª—å —á—É–≤—Å—Ç–≤—É–µ—Ç –ø–æ–¥—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ.

---

#### –ò–¥–µ—è 3: –¢–µ–∫—Å—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏ (Layering Strategy)
Ambient ‚Äî —ç—Ç–æ **–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –º—É–∑—ã–∫–∞** (—Å–ª–æ–∏ –≤–∞–∂–Ω–µ–µ –º–µ–ª–æ–¥–∏–∏).

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ë–ª—é–ø—Ä–∏–Ω—Ç —è–≤–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç **—Å–ª–æ–∏ –ø–æ —á–∞—Å—Ç—è–º**:
```typescript
type LayeringPlan = {
  part: number;
  layers: {
    bass: boolean;
    pad: boolean;
    arpeggio: boolean;
    sparkles: boolean;
    sfx: boolean;
    drums: boolean;
  };
};

const melancholicLayering: LayeringPlan[] = [
  { part: 1, layers: { bass: true, pad: true,  arpeggio: false, sparkles: false, sfx: false, drums: false } }, // Intro
  { part: 2, layers: { bass: true, pad: true,  arpeggio: true,  sparkles: false, sfx: true,  drums: true  } }, // Build
  { part: 3, layers: { bass: true, pad: true,  arpeggio: true,  sparkles: true,  sfx: true,  drums: true  } }, // Main
  { part: 4, layers: { bass: true, pad: true,  arpeggio: false, sparkles: true,  sfx: true,  drums: false } }, // Release
  { part: 5, layers: { bass: true, pad: false, arpeggio: false, sparkles: false, sfx: false, drums: false } }  // Outro
];
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- **–ß–∞—Å—Ç—å 1:** –¢–æ–ª—å–∫–æ –±–∞—Å + –ø–∞–¥ (–º–∏–Ω–∏–º–∞–ª–∏–∑–º).
- **–ß–∞—Å—Ç—å 3:** –í—Å–µ —Å–ª–æ–∏ (–∫—É–ª—å–º–∏–Ω–∞—Ü–∏—è).
- **–ß–∞—Å—Ç—å 5:** –¢–æ–ª—å–∫–æ –±–∞—Å (–≤–æ–∑–≤—Ä–∞—Ç –∫ –∏—Å—Ç–æ–∫–∞–º).

---

#### –ò–¥–µ—è 4: –ú–∏–∫—Ä–æ-—Å–æ–±—ã—Ç–∏—è (Ambient Details)
Ambient –∂–∏–≤—ë—Ç **–¥–µ—Ç–∞–ª—è–º–∏**: —Ä–µ–¥–∫–∏–µ –∑–≤—É–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ.

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å **event scheduler** –¥–ª—è —Å–ª—É—á–∞–π–Ω—ã—Ö –º–∏–∫—Ä–æ-—Å–æ–±—ã—Ç–∏–π:
```typescript
type AmbientEvent = {
  type: 'bell' | 'pad_swell' | 'reverse_cymbal' | 'granular_freeze';
  probability: number; // –ó–∞ —Ç–∞–∫—Ç
  timingVariance: number; // –î–∂–∏—Ç—Ç–µ—Ä (–Ω–µ —Ç–æ—á–Ω–æ –Ω–∞ –¥–æ–ª–µ)
  velocityRange: [number, number];
};

const melancholicAmbientEvents: AmbientEvent[] = [
  { 
    type: 'bell', 
    probability: 0.05,      // 5% —à–∞–Ω—Å –∫–∞–∂–¥—ã–π —Ç–∞–∫—Ç
    timingVariance: 0.3,    // ¬±30% –æ—Ç –¥–æ–ª–∏
    velocityRange: [20, 40] // –û—á–µ–Ω—å —Ç–∏—Ö–æ
  },
  { 
    type: 'pad_swell', 
    probability: 0.02, 
    timingVariance: 0.0,    // –¢–æ—á–Ω–æ –Ω–∞ –¥–æ–ª–µ
    velocityRange: [30, 50] 
  }
];
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
–ö–∞–∂–¥–∞—è —Å–µ—Å—Å–∏—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ "–ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è"** ‚Äî —Å–ª—É—á–∞–π–Ω—ã–π –∑–≤–æ–Ω –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫–∞, –≤–Ω–µ–∑–∞–ø–Ω–æ–µ –Ω–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ –ø–∞–¥–∞. –≠—Ç–æ –∏ –µ—Å—Ç—å "–∂–∏–≤–æ—Å—Ç—å".

---

## –ò–¢–û–ì–û–í–´–ï –ü–†–ò–ù–¶–ò–ü–´ (–º–æ–∏ + –≤–∞—à–∏, –æ—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—é–∏—Ç—ã
```
–°—é–∏—Ç–∞ (10-15 –º–∏–Ω)
‚îú‚îÄ –ß–∞—Å—Ç—å 1: INTRO (2-3 –º–∏–Ω)
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 1.1 (1 –º–∏–Ω): Bass + Pad (pedal)
‚îÇ  ‚îú‚îÄ [micro fill]
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 1.2 (1 –º–∏–Ω): + Arpeggio enters
‚îÇ  ‚îî‚îÄ [medium fill ‚Üí –ß–∞—Å—Ç—å 2]
‚îÇ
‚îú‚îÄ –ß–∞—Å—Ç—å 2: BUILD (3-4 –º–∏–Ω)
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 2.1: + Drums (soft)
‚îÇ  ‚îú‚îÄ [micro fill]
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 2.2: + SFX
‚îÇ  ‚îú‚îÄ [micro fill]
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 2.3: Increase density
‚îÇ  ‚îî‚îÄ [medium fill ‚Üí –ß–∞—Å—Ç—å 3]
‚îÇ
‚îú‚îÄ –ß–∞—Å—Ç—å 3: MAIN (4-5 –º–∏–Ω)
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 3.1: Full layers + Sparkles
‚îÇ  ‚îú‚îÄ [micro fill]
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 3.2: Peak tension
‚îÇ  ‚îú‚îÄ [micro fill]
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 3.3: Sustain
‚îÇ  ‚îî‚îÄ [medium fill ‚Üí –ß–∞—Å—Ç—å 4]
‚îÇ
‚îú‚îÄ –ß–∞—Å—Ç—å 4: RELEASE (2-3 –º–∏–Ω)
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 4.1: Remove drums
‚îÇ  ‚îú‚îÄ [micro fill]
‚îÇ  ‚îú‚îÄ –ë–∞–Ω–¥–ª 4.2: Thin texture
‚îÇ  ‚îî‚îÄ [medium fill ‚Üí –ß–∞—Å—Ç—å 5]
‚îÇ
‚îî‚îÄ –ß–∞—Å—Ç—å 5: OUTRO (1-2 –º–∏–Ω)
   ‚îú‚îÄ –ë–∞–Ω–¥–ª 5.1: Bass + Pad only
   ‚îî‚îÄ [fade to silence / loop back]
```

### 2. –ú—É—Ç–∞—Ü–∏–∏
```
–ú–∏–∫—Ä–æ (–±–∞–Ω–¥–ª ‚Üí –±–∞–Ω–¥–ª):
- –¢—Ä–∞–Ω—Å–ø–æ–∑–∏—Ü–∏—è ¬±2 –ø–æ–ª—É—Ç–æ–Ω–∞
- Rhythmic shift (—Å–º–µ—â–µ–Ω–∏–µ —Ñ–∞–∑—ã –Ω–∞ 1/8)
- Velocity variation ¬±10%
–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 30-70% (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è)

–°—Ä–µ–¥–Ω–∏–µ (—á–∞—Å—Ç—å ‚Üí —á–∞—Å—Ç—å):
- –ò–Ω–≤–µ—Ä—Å–∏—è —Ñ—Ä–∞–∑—ã
- –°–º–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ (¬±–æ–∫—Ç–∞–≤–∞)
- –°–º–µ–Ω–∞ –≤–æ–∏—Å–∏–Ω–≥–∞ –∞–∫–∫–æ—Ä–¥–æ–≤ (close ‚Üí open)
–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 60-90%

–ì–ª–æ–±–∞–ª—å–Ω—ã–µ (—Å—é–∏—Ç–∞ ‚Üí —Å—é–∏—Ç–∞):
- –ù–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–∫—Å–∏–æ–º
- –°–º–µ–Ω–∞ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ (D Dorian ‚Üí A Aeolian)
- –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–æ—ë–≤ (–±–∞—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–ª–æ–¥–∏–µ–π)
–¢—Ä–∏–≥–≥–µ—Ä: –∫–æ–Ω–µ—Ü —Å—é–∏—Ç—ã –∏–ª–∏ stagnation detection
```

### 3. –§–∏–ª–ª—ã (ambient-—Å—Ç–∏–ª—å)
```typescript
type AmbientFill = {
  duration: number; // —Ç–∞–∫—Ç–æ–≤
  technique: 
    | 'filter_sweep'      // LPF 3kHz ‚Üí 12kHz –∑–∞ 1 —Ç–∞–∫—Ç
    | 'reverb_burst'      // Reverb wet 30% ‚Üí 80% ‚Üí 30%
    | 'harmonic_glide'    // –ê–∫–∫–æ—Ä–¥ "—Å—ä–µ–∑–∂–∞–µ—Ç" –Ω–∞ ¬±1 –ø–æ–ª—É—Ç–æ–Ω –∏ –æ–±—Ä–∞—Ç–Ω–æ
    | 'density_pause'     // –í—Å–µ —Å–ª–æ–∏ –∫—Ä–æ–º–µ –æ–¥–Ω–æ–≥–æ –º–æ–ª—á–∞—Ç 1 —Ç–∞–∫—Ç
    | 'granular_freeze';  // Freeze —Ç–µ–∫—É—â–µ–≥–æ –∑–≤—É–∫–∞ –Ω–∞ 2 —Ç–∞–∫—Ç–∞
};

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
–ë–∞–Ω–¥–ª 1 ‚Üí [filter_sweep 1 —Ç–∞–∫—Ç] ‚Üí –ë–∞–Ω–¥–ª 2
–ß–∞—Å—Ç—å 2 ‚Üí [reverb_burst 2 —Ç–∞–∫—Ç–∞] ‚Üí –ß–∞—Å—Ç—å 3
```

### 4. –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å (—É–ø—Ä–∞–≤–ª—è–µ–º–∞—è)
```
–ü—Ä–∞–≤–∏–ª–æ "–Ø–∫–æ—Ä—è":
- –í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–≤—É—á–∏—Ç –º–∏–Ω–∏–º—É–º 1 "—è–∫–æ—Ä–Ω—ã–π" —Å–ª–æ–π (–±–∞—Å –∏–ª–∏ –ø–∞–¥).
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–∞—É–∑–∞ –¥–ª—è —è–∫–æ—Ä—è: 4 —Ç–∞–∫—Ç–∞ (—Ç–æ–ª—å–∫–æ –≤ intro/outro).
- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª–æ–∏ –º–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è/–∏—Å—á–µ–∑–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ.

–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –ø–æ —á–∞—Å—Ç—è–º (–¥–ª—è melancholic):
Intro:   30-50% (—Ä–∞–∑—Ä–µ–∂–µ–Ω–æ)
Build:   50-70%
Main:    70-90% (–≥—É—Å—Ç–æ)
Release: 40-60%
Outro:   20-40%
```

### 5. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–Ω—Ç—Ä–æ
```typescript
introDuration = 90 * (52 / bpm); // —Å–µ–∫—É–Ω–¥
clamp(introDuration, 30, 180);

–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—Ö–æ–¥–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:
Bass:          0% (—Å—Ä–∞–∑—É)
Pad:           25% –∏–Ω—Ç—Ä–æ
Arpeggio:      50% –∏–Ω—Ç—Ä–æ
Drums:         75% –∏–Ω—Ç—Ä–æ
Sparkles/SFX:  100% (= –Ω–∞—á–∞–ª–æ BUILD)
```

### 6. –ë–ª—é–ø—Ä–∏–Ω—Ç = –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∞—è —Å—Ö–µ–º–∞
```typescript
type BlueprintParameter = {
  value?: number;           // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  range?: [number, number]; // –î–∏–∞–ø–∞–∑–æ–Ω (–≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)
  options?: Array<{ value: any; weight: number }>; // –í–∑–≤–µ—à–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä
};

// –ü—Ä–∏–º–µ—Ä:
bassTechnique: {
  options: [
    { value: 'pedal', weight: 0.7 },
    { value: 'drone', weight: 0.3 }
  ]
}
```

---

## –ß–¢–û –î–ê–õ–¨–®–ï?

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω—ã, –ø—Ä–µ–¥–ª–∞–≥–∞—é **–Ω–∞–ø–∏—Å–∞—Ç—å –æ–¥–∏–Ω —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –±–ª—é–ø—Ä–∏–Ω—Ç** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `melancholic`) **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ**, —Å:
- –¢–æ—á–Ω—ã–º–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ —á–∞—Å—Ç–µ–π –∏ –±–∞–Ω–¥–ª–æ–≤
- –°–ø–∏—Å–∫–æ–º —Ç–µ—Ö–Ω–∏–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- –ü—Ä–∞–≤–∏–ª–∞–º–∏ –º—É—Ç–∞—Ü–∏–π
- –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–µ–π
- Layering plan
- Ambient events

–ê –∑–∞—Ç–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 7 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π, –≤–∞—Ä—å–∏—Ä—É—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

**–ù–∞—á–∞—Ç—å —Å `melancholic`? –ò–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ —É—Ç–æ—á–Ω–∏—Ç—å/–æ—Å–ø–æ—Ä–∏—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –∏–∑ –º–æ–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π?**
# MELANCHOLIC AMBIENT BLUEPRINT (—ç—Ç–∞–ª–æ–Ω–Ω—ã–π)

## –û–±—â–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

```typescript
// src/lib/blueprints/melancholic-ambient.ts

import { MusicBlueprint, TensionProfile, HarmonicCenter, LayeringPlan } from '@/types/music';

export const MelancholicAmbientBlueprint: MusicBlueprint = {
  // ============================================================================
  // –ú–ï–¢–ê–î–ê–ù–ù–´–ï
  // ============================================================================
  
  id: 'melancholic_ambient',
  name: 'Melancholic Drift',
  description: '–ó–∞–¥—É–º—á–∏–≤—ã–π, –∏–Ω—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–π ambient —Å –ø–ª–∞–≤–Ω—ã–º–∏ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏',
  
  mood: 'melancholic',
  
  // ============================================================================
  // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ú–£–ó–´–ö–ê–õ–¨–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´
  // ============================================================================
  
  musical: {
    key: {
      root: 'D',
      scale: 'dorian', // D E F G A B C ‚Äî –º—è–≥–∫–∏–π –º–∏–Ω–æ—Ä —Å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–π —Å–µ–∫—Å—Ç–æ–π
      octave: 3        // D3 –∫–∞–∫ –æ–ø–æ—Ä–Ω–∞—è —Ç–æ—á–∫–∞
    },
    
    bpm: {
      base: 52,
      range: [48, 56],    // –î–æ–ø—É—Å—Ç–∏–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (–º–æ–∂–µ—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è)
      modifier: 0.95      // –ò–∑ MoodProfile (—á—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–≥–æ)
    },
    
    timeSignature: {
      numerator: 4,
      denominator: 4
    },
    
    // –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –≤—Å–µ–π —Å—é–∏—Ç—ã (–∫—Ä—É–ø–Ω—ã–π –ø–ª–∞–Ω)
    harmonicJourney: [
      {
        partIndex: 0,           // INTRO
        center: 'Dm7',          // –¢–æ–Ω–∏–∫–∞ (D F A C)
        satellites: ['Gm7', 'Am7'], // –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ "—Å–æ—Å–µ–¥–∏"
        weight: 0.8             // 80% –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ Dm7
      },
      {
        partIndex: 1,           // BUILD
        center: 'Gm7',          // –°—É–±–¥–æ–º–∏–Ω–∞–Ω—Ç–∞ (G Bb D F)
        satellites: ['Dm7', 'Cmaj7'],
        weight: 0.6             // –ë–æ–ª—å—à–µ –¥–≤–∏–∂–µ–Ω–∏—è
      },
      {
        partIndex: 2,           // MAIN
        center: 'Am7',          // –î–æ–º–∏–Ω–∞–Ω—Ç–∞ (A C E G)
        satellites: ['Dm7', 'Fmaj7', 'Em7b5'],
        weight: 0.5             // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–≤–æ–±–æ–¥–∞
      },
      {
        partIndex: 3,           // RELEASE
        center: 'Fmaj7',        // bIII (F A C E) ‚Äî –ª–∏—Ä–∏—á–µ—Å–∫–∏–π –∞–∫–∫–æ—Ä–¥
        satellites: ['Dm7', 'Gm7'],
        weight: 0.7
      },
      {
        partIndex: 4,           // OUTRO
        center: 'Dm7',          // –í–æ–∑–≤—Ä–∞—Ç –∫ —Ç–æ–Ω–∏–∫–µ
        satellites: [],         // –¢–æ–ª—å–∫–æ —Ç–æ–Ω–∏–∫–∞ (—Å—Ç–∞—Ç–∏–∫–∞)
        weight: 1.0
      }
    ] as HarmonicCenter[],
    
    // –ú–∞—Å—à—Ç–∞–±–Ω–∞—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫—Ä–∏–≤–∞—è (tension)
    tensionProfile: {
      type: 'arc',              // –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥—É–≥–∞
      peakPosition: 0.58,       // –ü–∏–∫ –Ω–∞ 58% –¥–ª–∏–Ω—ã —Å—é–∏—Ç—ã
      curve: (progress: number, peakPos: number): number => {
        if (progress < peakPos) {
          // –†–æ—Å—Ç: –º–µ–¥–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç, —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∫ –ø–∏–∫—É
          return Math.pow(progress / peakPos, 1.3);
        } else {
          // –°–ø–∞–¥: –ø–ª–∞–≤–Ω–æ–µ –∑–∞—Ç—É—Ö–∞–Ω–∏–µ
          return Math.pow((1 - progress) / (1 - peakPos), 1.8);
        }
      }
    } as TensionProfile
  },
  
  // ============================================================================
  // –°–¢–†–£–ö–¢–£–†–ê –°–Æ–ò–¢–´ (–∏–µ—Ä–∞—Ä—Ö–∏—è)
  // ============================================================================
  
  structure: {
    totalDuration: {
      bars: { min: 220, max: 280 }, // @ 52 BPM = 11-14 –º–∏–Ω—É—Ç
      preferredBars: 250            // –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    },
    
    parts: [
      // ========================================================================
      // –ß–ê–°–¢–¨ 1: INTRO (–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ)
      // ========================================================================
      {
        id: 'INTRO',
        name: 'Awakening',
        
        duration: {
          bars: { min: 24, max: 32 },
          bundles: { min: 2, max: 3 }  // 2-3 –±–∞–Ω–¥–ª–∞
        },
        
        // –°–ª–æ–∏ (–∫–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã)
        layers: {
          bass: true,
          pad: true,
          arpeggio: false,      // –í—Ö–æ–¥–∏—Ç –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ INTRO
          melody: false,
          sparkles: false,      // –¢–æ–ª—å–∫–æ —Å BUILD
          sfx: false,
          drums: false
        },
        
        // –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—Ö–æ–¥–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç –¥–ª–∏–Ω—ã —á–∞—Å—Ç–∏)
        instrumentEntry: {
          bass: 0.0,            // –°—Ä–∞–∑—É
          pad: 0.25,            // 25% INTRO (–µ—Å–ª–∏ INTRO = 28 —Ç–∞–∫—Ç–æ–≤ ‚Üí —Ç–∞–∫—Ç 7)
          arpeggio: 0.65,       // 65% INTRO
          // –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–µ –≤—Ö–æ–¥—è—Ç
        },
        
        // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
        instrumentRules: {
          bass: {
            techniques: [
              { value: 'pedal', weight: 0.8 },      // 80% ‚Äî –¥–æ–ª–≥–∏–µ –ø–µ–¥–∞–ª–∏
              { value: 'drone', weight: 0.2 }       // 20% ‚Äî —Å—É–±-–±–∞—Å –¥—Ä–æ–Ω
            ],
            register: {
              preferred: 'low',   // D1-G2
              range: { min: 26, max: 43 } // MIDI (D1 = 26, G2 = 43)
            },
            density: { min: 0.25, max: 0.4 }, // –†–µ–¥–∫–æ (25-40% –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏)
            noteDuration: {
              type: 'long',       // –¶–µ–ª—ã–µ –Ω–æ—Ç—ã, –ø–æ–ª–æ–≤–∏–Ω–Ω—ã–µ
              range: [8, 16]      // –í –¥–æ–ª—è—Ö (8 = 2 —Ç–∞–∫—Ç–∞, 16 = 4 —Ç–∞–∫—Ç–∞)
            },
            velocity: { min: 50, max: 70 },
            articulation: 'legato',
            
            // ADSR –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞
            envelope: {
              attack: { min: 800, max: 1500 },   // –º—Å
              decay: { min: 300, max: 600 },
              sustain: { min: 0.7, max: 0.85 },
              release: { min: 2000, max: 4000 }
            }
          },
          
          pad: {
            techniques: [
              { value: 'swell', weight: 0.6 },      // –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –Ω–∞—Ä–∞—Å—Ç–∞–Ω–∏—è
              { value: 'sustained', weight: 0.4 }   // –°—Ç–∞—Ç–∏—á–Ω—ã–µ –∞–∫–∫–æ—Ä–¥—ã
            ],
            register: {
              preferred: 'mid',
              range: { min: 48, max: 72 } // C3-C5
            },
            density: { min: 0.6, max: 0.8 }, // –ë–æ–ª–µ–µ –ø–ª–æ—Ç–Ω–æ, —á–µ–º –±–∞—Å
            voicing: {
              type: 'open',       // –®–∏—Ä–æ–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ (ambient!)
              spread: { min: 12, max: 24 } // –û–∫—Ç–∞–≤–∞-–¥–≤–µ –º–µ–∂–¥—É –≥–æ–ª–æ—Å–∞–º–∏
            },
            voices: { min: 3, max: 4 },   // 3-4 –Ω–æ—Ç—ã –≤ –∞–∫–∫–æ—Ä–¥–µ
            velocity: { min: 40, max: 60 },
            
            envelope: {
              attack: { min: 1200, max: 2500 },
              decay: { min: 800, max: 1200 },
              sustain: { min: 0.75, max: 0.9 },
              release: { min: 4000, max: 8000 }
            },
            
            // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –ø–∞–¥–∞ —ç—Ñ—Ñ–µ–∫—Ç—ã
            effects: {
              chorus: { depth: 0.15, rate: 0.4 },
              reverb: { wet: 0.45, size: 0.85 }
            }
          },
          
          arpeggio: {
            techniques: [
              { value: 'slow_ascend', weight: 0.5 },
              { value: 'slow_descend', weight: 0.3 },
              { value: 'random_sparse', weight: 0.2 }
            ],
            register: {
              preferred: 'mid-high',
              range: { min: 60, max: 84 } // C4-C6
            },
            density: { min: 0.3, max: 0.5 },
            noteDuration: {
              type: 'medium',
              range: [2, 4] // –ü–æ–ª–æ–≤–∏–Ω–Ω—ã–µ, —á–µ—Ç–≤–µ—Ä—Ç–Ω—ã–µ
            },
            velocity: { min: 35, max: 55 }, // –¢–∏—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
            
            pattern: {
              noteCount: { min: 3, max: 5 },  // 3-5 –Ω–æ—Ç –≤ –ø–∞—Ç—Ç–µ—Ä–Ω–µ
              direction: {
                ascending: 0.5,
                descending: 0.4,
                alternating: 0.1
              }
            }
          }
        },
        
        // –ë–∞–Ω–¥–ª—ã (–ø–æ–¥—Ä–∞–∑–¥–µ–ª—ã —á–∞—Å—Ç–∏)
        bundles: [
          {
            id: 'INTRO_BUNDLE_1',
            name: 'Emergence',
            duration: { min: 12, max: 16 }, // —Ç–∞–∫—Ç–æ–≤
            
            // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —ç—Ç–æ–≥–æ –±–∞–Ω–¥–ª–∞
            characteristics: {
              harmonicMovement: 'static',     // –ü–æ—á—Ç–∏ –±–µ–∑ –¥–≤–∏–∂–µ–Ω–∏—è
              densityBias: -0.1,              // –ù–∞ 10% —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–µ–µ –±–∞–∑–æ–≤–æ–π
              filterCutoff: { min: 0.4, max: 0.6 }, // 40-60% –æ—Ç –º–∞–∫—Å. (–ø—Ä–∏–≥–ª—É—à–µ–Ω–æ)
              reverbWet: 0.5
            },
            
            // –§—Ä–∞–∑—ã (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –≤–Ω—É—Ç—Ä–∏ –±–∞–Ω–¥–ª–∞)
            phrases: {
              count: { min: 3, max: 4 },      // 3-4 —Ñ—Ä–∞–∑—ã –ø–æ 4 —Ç–∞–∫—Ç–∞
              length: { min: 4, max: 4 }      // –í—Å–µ —Ñ—Ä–∞–∑—ã –ø–æ 4 —Ç–∞–∫—Ç–∞ (—Å–∏–º–º–µ—Ç—Ä–∏—è)
            }
          },
          
          {
            id: 'INTRO_BUNDLE_2',
            name: 'Unfolding',
            duration: { min: 12, max: 16 },
            
            characteristics: {
              harmonicMovement: 'slight',     // –õ—ë–≥–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ (Dm7 ‚Üí Gm7)
              densityBias: 0.0,
              filterCutoff: { min: 0.5, max: 0.7 }, // –ü—Ä–∏–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
              reverbWet: 0.55
            },
            
            phrases: {
              count: { min: 3, max: 4 },
              length: { min: 4, max: 4 }
            }
          }
        ],
        
        // –§–∏–ª–ª –Ω–∞ –≤—ã—Ö–æ–¥–µ –∏–∑ —á–∞—Å—Ç–∏ (–ø–µ—Ä–µ—Ö–æ–¥ –≤ BUILD)
        outroFill: {
          type: 'filter_sweep',
          duration: 2,            // —Ç–∞–∫—Ç–∞
          parameters: {
            filterStart: 0.6,     // 60% cutoff
            filterEnd: 0.95,      // 95% cutoff (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è)
            curve: 'exponential'  // –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ü—É
          }
        }
      },
      
      // ========================================================================
      // –ß–ê–°–¢–¨ 2: BUILD (–ù–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ)
      // ========================================================================
      {
        id: 'BUILD',
        name: 'Rising',
        
        duration: {
          bars: { min: 48, max: 64 },
          bundles: { min: 3, max: 4 }
        },
        
        layers: {
          bass: true,
          pad: true,
          arpeggio: true,
          melody: false,
          sparkles: true,         // –í–•–û–î–Ø–¢!
          sfx: true,              // –í–•–û–î–Ø–¢!
          drums: true             // –í–•–û–î–Ø–¢!
        },
        
        instrumentEntry: {
          sparkles: 0.0,          // –°—Ä–∞–∑—É –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ BUILD
          sfx: 0.15,              // 15% BUILD
          drums: 0.35             // 35% BUILD (–ø–æ–∑–∂–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö)
        },
        
        instrumentRules: {
          bass: {
            techniques: [
              { value: 'ostinato', weight: 0.5 },   // –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è —Ñ–∏–≥—É—Ä–∞
              { value: 'walking', weight: 0.3 },    // –ü–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
              { value: 'pedal', weight: 0.2 }
            ],
            register: {
              preferred: 'low-mid',
              range: { min: 26, max: 50 } // –î–æ D3
            },
            density: { min: 0.5, max: 0.7 }, // –ü–ª–æ—Ç–Ω–µ–µ, —á–µ–º –≤ INTRO
            noteDuration: {
              type: 'mixed',
              range: [2, 8] // –û—Ç —á–µ—Ç–≤–µ—Ä—Ç–Ω—ã—Ö –¥–æ 2-—Ç–∞–∫—Ç–æ–≤—ã—Ö
            },
            velocity: { min: 60, max: 80 },
            
            envelope: {
              attack: { min: 400, max: 800 },    // –ö–æ—Ä–æ—á–µ, —á–µ–º –≤ INTRO
              decay: { min: 200, max: 400 },
              sustain: { min: 0.65, max: 0.8 },
              release: { min: 1500, max: 3000 }
            }
          },
          
          pad: {
            // –¢–µ –∂–µ —Ç–µ—Ö–Ω–∏–∫–∏, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ–Ω—è—é—Ç—Å—è
            techniques: [
              { value: 'sustained', weight: 0.5 },
              { value: 'swell', weight: 0.4 },
              { value: 'tremolo', weight: 0.1 }     // –ù–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞!
            ],
            register: {
              preferred: 'mid',
              range: { min: 48, max: 76 } // –†–∞—Å—à–∏—Ä—è–µ–º –≤–≤–µ—Ä—Ö
            },
            density: { min: 0.7, max: 0.85 },
            voices: { min: 4, max: 5 },           // –ë–æ–ª—å—à–µ –≥–æ–ª–æ—Å–æ–≤
            velocity: { min: 50, max: 70 },       // –ì—Ä–æ–º—á–µ
            
            effects: {
              chorus: { depth: 0.18, rate: 0.5 },
              reverb: { wet: 0.5, size: 0.9 }
            }
          },
          
          arpeggio: {
            techniques: [
              { value: 'slow_ascend', weight: 0.4 },
              { value: 'slow_descend', weight: 0.4 },
              { value: 'bidirectional', weight: 0.2 } // –í–≤–µ—Ä—Ö-–≤–Ω–∏–∑
            ],
            register: {
              preferred: 'mid-high',
              range: { min: 60, max: 88 } // –î–æ E6 (—Ä–∞—Å—à–∏—Ä—è–µ–º)
            },
            density: { min: 0.5, max: 0.7 }, // –ê–∫—Ç–∏–≤–Ω–µ–µ
            velocity: { min: 45, max: 65 },
            
            pattern: {
              noteCount: { min: 4, max: 6 },
              direction: {
                ascending: 0.4,
                descending: 0.4,
                alternating: 0.2
              }
            }
          },
          
          sparkles: {
            techniques: [
              { value: 'random_high', weight: 1.0 } // –í—ã—Å–æ–∫–∏–µ —Å–ª—É—á–∞–π–Ω—ã–µ –Ω–æ—Ç—ã
            ],
            register: {
              preferred: 'high',
              range: { min: 72, max: 96 } // C5-C7
            },
            density: { min: 0.1, max: 0.25 }, // –û—á–µ–Ω—å —Ä–µ–¥–∫–æ (—É–∫—Ä–∞—à–µ–Ω–∏–µ)
            noteDuration: {
              type: 'short',
              range: [0.5, 2] // –ö–æ—Ä–æ—Ç–∫–∏–µ –≤—Å–ø—ã—à–∫–∏
            },
            velocity: { min: 30, max: 50 }, // –¢–∏—Ö–æ
            
            effects: {
              reverb: { wet: 0.7, size: 0.95 }, // –î–ª–∏–Ω–Ω—ã–π —Ö–≤–æ—Å—Ç
              delay: { 
                time: 0.375,  // Dotted 1/8
                feedback: 0.3,
                wet: 0.4
              }
            },
            
            // –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è (–Ω–∞ —Ç–∞–∫—Ç)
            eventProbability: 0.08 // 8% –∫–∞–∂–¥—ã–π —Ç–∞–∫—Ç
          },
          
          sfx: {
            techniques: [
              { value: 'air_texture', weight: 0.4 },
              { value: 'vinyl_crackle', weight: 0.3 },
              { value: 'water_droplets', weight: 0.2 },
              { value: 'field_recording', weight: 0.1 }
            ],
            
            // SFX –Ω–µ –∏–º–µ—é—Ç —á—ë—Ç–∫–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞ (—ç—Ç–æ —Ç–µ–∫—Å—Ç—É—Ä—ã)
            density: { min: 0.3, max: 0.5 }, // –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ–¥–ª–æ–∂–∫–∞
            velocity: { min: 25, max: 40 },  // –û—á–µ–Ω—å —Ç–∏—Ö–æ (-32 dB)
            
            layering: {
              maxSimultaneous: 2,   // –ù–µ –±–æ–ª—å—à–µ 2 SFX –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
              crossfadeDuration: 4  // –ü–ª–∞–≤–Ω–∞—è —Å–º–µ–Ω–∞ (4 —Ç–∞–∫—Ç–∞)
            }
          },
          
          drums: {
            // –¢–æ–ª—å–∫–æ –º—è–≥–∫–∞—è –ø–µ—Ä–∫—É—Å—Å–∏—è –¥–ª—è ambient
            kit: [
              { 
                type: 'shaker',
                pattern: 'eighth_notes_sparse', // –í–æ—Å—å–º—ã–µ, —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ
                velocity: { min: 40, max: 55 },
                probability: 0.6 // –ù–µ –≤—Å–µ–≥–¥–∞ –∏–≥—Ä–∞–µ—Ç
              },
              { 
                type: 'soft_tom',
                pattern: 'quarter_notes_offbeat',
                velocity: { min: 45, max: 60 },
                probability: 0.4
              },
              { 
                type: 'ride_bell',
                pattern: 'dotted_quarter',
                velocity: { min: 35, max: 50 },
                probability: 0.3
              }
            ],
            
            density: { min: 0.25, max: 0.4 }, // –†–µ–¥–∫–æ (ambient!)
            
            groove: {
              swing: 0.0,         // –ü—Ä—è–º–æ–π —Ä–∏—Ç–º
              humanize: 0.15,     // 15% timing variance
              velocityVariance: 0.1
            }
          }
        },
        
        bundles: [
          {
            id: 'BUILD_BUNDLE_1',
            name: 'Stirring',
            duration: { min: 16, max: 20 },
            
            characteristics: {
              harmonicMovement: 'moderate',   // Dm7 ‚Üí Gm7 ‚Üí Am7
              densityBias: 0.05,
              filterCutoff: { min: 0.65, max: 0.8 },
              reverbWet: 0.55
            },
            
            phrases: {
              count: { min: 4, max: 5 },
              length: { min: 4, max: 4 }
            }
          },
          
          {
            id: 'BUILD_BUNDLE_2',
            name: 'Intensifying',
            duration: { min: 16, max: 20 },
            
            characteristics: {
              harmonicMovement: 'active',
              densityBias: 0.1,              // –ï—â—ë –ø–ª–æ—Ç–Ω–µ–µ
              filterCutoff: { min: 0.75, max: 0.9 },
              reverbWet: 0.6
            },
            
            phrases: {
              count: { min: 4, max: 5 },
              length: { min: 4, max: 4 }
            }
          },
          
          {
            id: 'BUILD_BUNDLE_3',
            name: 'Anticipation',
            duration: { min: 12, max: 16 },
            
            characteristics: {
              harmonicMovement: 'tense',      // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∫—É–ª—å–º–∏–Ω–∞—Ü–∏–∏
              densityBias: 0.15,
              filterCutoff: { min: 0.85, max: 0.95 },
              reverbWet: 0.65
            },
            
            phrases: {
              count: { min: 3, max: 4 },
              length: { min: 4, max: 4 }
            }
          }
        ],
        
        outroFill: {
          type: 'reverb_burst',
          duration: 2,
          parameters: {
            reverbStart: 0.5,
            reverbPeak: 0.9,      // –†–µ–∑–∫–∏–π –≤—Å–ø–ª–µ—Å–∫ —Ä–µ–≤–µ—Ä–±–∞
            reverbEnd: 0.55,
            curve: 'triangular'   // –í–≤–µ—Ä—Ö-–≤–Ω–∏–∑
          }
        }
      },
      
      // ========================================================================
      // –ß–ê–°–¢–¨ 3: MAIN (–ö—É–ª—å–º–∏–Ω–∞—Ü–∏—è)
      // ========================================================================
      {
        id: 'MAIN',
        name: 'Apex',
        
        duration: {
          bars: { min: 80, max: 100 }, // –°–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è —á–∞—Å—Ç—å
          bundles: { min: 4, max: 5 }
        },
        
        layers: {
          bass: true,
          pad: true,
          arpeggio: true,
          melody: true,           // –í–•–û–î–ò–¢! (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
          sparkles: true,
          sfx: true,
          drums: true
        },
        
        instrumentEntry: {
          melody: 0.25            // 25% MAIN (–Ω–µ —Å—Ä–∞–∑—É, –¥–∞—ë–º —Ä–∞–∑–≤–∏—Ç—å—Å—è)
        },
        
        instrumentRules: {
          bass: {
            techniques: [
              { value: 'walking', weight: 0.5 },
              { value: 'ostinato', weight: 0.4 },
              { value: 'melodic', weight: 0.1 }   // –ë–∞—Å –∫–∞–∫ –º–µ–ª–æ–¥–∏—è (—Ä–µ–¥–∫–æ)
            ],
            register: {
              preferred: 'low-mid',
              range: { min: 26, max: 55 } // –î–æ G3
            },
            density: { min: 0.65, max: 0.85 }, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
            noteDuration: {
              type: 'mixed',
              range: [1, 6]
            },
            velocity: { min: 65, max: 85 },
            
            envelope: {
              attack: { min: 200, max: 500 },
              decay: { min: 150, max: 300 },
              sustain: { min: 0.7, max: 0.85 },
              release: { min: 1000, max: 2000 }
            }
          },
          
          pad: {
            techniques: [
              { value: 'sustained', weight: 0.4 },
              { value: 'swell', weight: 0.3 },
              { value: 'tremolo', weight: 0.2 },
              { value: 'shimmer', weight: 0.1 }   // –†–µ–≤–µ—Ä–±+–æ–∫—Ç–∞–≤–∞ –≤–≤–µ—Ä—Ö
            ],
            register: {
              preferred: 'mid',
              range: { min: 48, max: 84 } // –î–æ C6
            },
            density: { min: 0.8, max: 0.95 }, // –ü–æ—á—Ç–∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ
            voices: { min: 4, max: 6 },
            velocity: { min: 55, max: 75 },
            
            effects: {
              chorus: { depth: 0.2, rate: 0.6 },
              reverb: { wet: 0.55, size: 0.95 },
              shimmer: { wet: 0.15, octave: 1 } // –î–ª—è —Ç–µ—Ö–Ω–∏–∫–∏ 'shimmer'
            }
          },
          
          arpeggio: {
            techniques: [
              { value: 'bidirectional', weight: 0.4 },
              { value: 'random_structured', weight: 0.3 },
              { value: 'slow_ascend', weight: 0.2 },
              { value: 'broken_chord', weight: 0.1 }
            ],
            register: {
              preferred: 'mid-high',
              range: { min: 60, max: 92 }
            },
            density: { min: 0.6, max: 0.8 },
            velocity: { min: 50, max: 70 },
            
            pattern: {
              noteCount: { min: 5, max: 8 }, // –î–ª–∏–Ω–Ω–µ–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
              direction: {
                ascending: 0.3,
                descending: 0.3,
                alternating: 0.4
              }
            }
          },
          
          melody: {
            techniques: [
              { value: 'sparse_legato', weight: 0.5 }, // –†–µ–¥–∫–∏–µ, —Å–≤—è–∑–Ω—ã–µ —Ñ—Ä–∞–∑—ã
              { value: 'intervallic', weight: 0.3 },   // –°–∫–∞—á–∫–∏ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º
              { value: 'ornamental', weight: 0.2 }     // –° —É–∫—Ä–∞—à–µ–Ω–∏—è–º–∏
            ],
            register: {
              preferred: 'mid-high',
              range: { min: 60, max: 88 }
            },
            density: { min: 0.2, max: 0.4 }, // –†–µ–¥–∫–æ (–Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å)
            noteDuration: {
              type: 'lyrical',
              range: [2, 12] // –û—Ç —á–µ—Ç–≤–µ—Ä—Ç–Ω—ã—Ö –¥–æ 3-—Ç–∞–∫—Ç–æ–≤—ã—Ö
            },
            velocity: { min: 45, max: 65 },
            
            phrasing: {
              phraseLength: { min: 4, max: 8 }, // –¢–∞–∫—Ç—ã
              restBetween: { min: 4, max: 12 }, // –ü–∞—É–∑—ã –º–µ–∂–¥—É —Ñ—Ä–∞–∑–∞–º–∏
              contour: {
                arch: 0.4,        // –§—Ä–∞–∑–∞ –≤–≤–µ—Ä—Ö-–≤–Ω–∏–∑
                ascending: 0.3,   // –í–æ—Å—Ö–æ–¥—è—â–∞—è
                descending: 0.3   // –ù–∏—Å—Ö–æ–¥—è—â–∞—è (–¥–ª—è melancholic)
              }
            },
            
            effects: {
              reverb: { wet: 0.6, size: 0.9 },
              delay: {
                time: 0.5,  // –ü–æ–ª–æ–≤–∏–Ω–Ω–∞—è –Ω–æ—Ç–∞
                feedback: 0.25,
                wet: 0.3
              }
            }
          },
          
          sparkles: {
            // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∫ –≤ BUILD, –Ω–æ —á–∞—â–µ
            eventProbability: 0.12, // 12% –∫–∞–∂–¥—ã–π —Ç–∞–∫—Ç
            velocity: { min: 35, max: 55 }
          },
          
          sfx: {
            density: { min: 0.4, max: 0.6 }, // –ë–æ–ª–µ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ
            velocity: { min: 30, max: 45 }
          },
          
          drums: {
            kit: [
              { 
                type: 'shaker',
                pattern: 'eighth_notes_moderate',
                velocity: { min: 45, max: 60 },
                probability: 0.8
              },
              { 
                type: 'soft_tom',
                pattern: 'syncopated',
                velocity: { min: 50, max: 65 },
                probability: 0.5
              },
              { 
                type: 'ride_bell',
                pattern: 'quarter_and_eighth',
                velocity: { min: 40, max: 55 },
                probability: 0.5
              },
              { 
                type: 'frame_drum',       // –ù–û–í–´–ô —ç–ª–µ–º–µ–Ω—Ç
                pattern: 'occasional_hits',
                velocity: { min: 55, max: 70 },
                probability: 0.3
              }
            ],
            
            density: { min: 0.45, max: 0.65 },
            
            groove: {
              swing: 0.05,        // –õ—ë–≥–∫–∏–π swing –¥–ª—è –∂–∏–≤–æ—Å—Ç–∏
              humanize: 0.2,
              velocityVariance: 0.15
            }
          }
        },
        
        bundles: [
          {
            id: 'MAIN_BUNDLE_1',
            name: 'Arrival',
            duration: { min: 20, max: 24 },
            
            characteristics: {
              harmonicMovement: 'free',       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–≤–æ–±–æ–¥–∞
              densityBias: 0.15,
              filterCutoff: { min: 0.9, max: 1.0 }, // –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫—Ä—ã—Ç
              reverbWet: 0.6
            },
            
            phrases: {
              count: { min: 5, max: 6 },
              length: { min: 4, max: 4 }
            }
          },
          
          {
            id: 'MAIN_BUNDLE_2',
            name: 'Sustain',
            duration: { min: 20, max: 24 },
            
            characteristics: {
              harmonicMovement: 'expansive',  // –®–∏—Ä–æ–∫–∏–µ –≥–∞—Ä–º–æ–Ω–∏–∏
              densityBias: 0.2,               // –ü–∏–∫ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
              filterCutoff: { min: 0.95, max: 1.0 },
              reverbWet: 0.65
            },
            
            phrases: {
              count: { min: 5, max: 6 },
              length: { min: 4, max: 4 }
            }
          },
          
          {
            id: 'MAIN_BUNDLE_3',
            name: 'Plateau',
            duration: { min: 16, max: 20 },
            
            characteristics: {
              harmonicMovement: 'stable',     // –î–æ–ª–≥–æ–µ –ø–ª–∞—Ç–æ
              densityBias: 0.15,
              filterCutoff: { min: 0.9, max: 1.0 },
              reverbWet: 0.65
            },
            
            phrases: {
              count: { min: 4, max: 5 },
              length: { min: 4, max: 4 }
            }
          },
          
          {
            id: 'MAIN_BUNDLE_4',
            name: 'Reflection',
            duration: { min: 16, max: 20 },
            
            characteristics: {
              harmonicMovement: 'resolving',  // –ù–∞—á–∞–ª–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
              densityBias: 0.1,
              filterCutoff: { min: 0.85, max: 0.95 },
              reverbWet: 0.6
            },
            
            phrases: {
              count: { min: 4, max: 5 },
              length: { min: 4, max: 4 }
            }
          }
        ],
        
        outroFill: {
          type: 'harmonic_glide',
          duration: 4,
          parameters: {
            glideAmount: -0.5,    // –ü–æ–ª—É—Ç–æ–Ω –≤–Ω–∏–∑
            glideCurve: 'sine',   // –ü–ª–∞–≤–Ω–∞—è –≤–æ–ª–Ω–∞
            returnToOrigin: true
          }
        }
      },
      
      // ========================================================================
      // –ß–ê–°–¢–¨ 4: RELEASE (–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ)
      // ========================================================================
      {
        id: 'RELEASE',
        name: 'Descent',
        
        duration: {
          bars: { min: 40, max: 56 },
          bundles: { min: 2, max: 3 }
        },
        
        layers: {
          bass: true,
          pad: true,
          arpeggio: true,
          melody: false,          // –£–•–û–î–ò–¢
          sparkles: true,
          sfx: true,
          drums: false            // –£–•–û–î–Ø–¢
        },
        
        instrumentExit: {
          melody: 0.0,            // –°—Ä–∞–∑—É –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ RELEASE
          drums: 0.15             // 15% RELEASE
        },
        
        instrumentRules: {
          bass: {
            techniques: [
              { value: 'pedal', weight: 0.6 },      // –í–æ–∑–≤—Ä–∞—Ç –∫ –ø–µ–¥–∞–ª—è–º
              { value: 'ostinato', weight: 0.3 },
              { value: 'drone', weight: 0.1 }
            ],
            register: {
              preferred: 'low',
              range: { min: 26, max: 48 }
            },
            density: { min: 0.4, max: 0.6 }, // –†–∞–∑—Ä–µ–∂–∞–µ–º
            velocity: { min: 55, max: 75 },
            
            envelope: {
              attack: { min: 600, max: 1200 },
              decay: { min: 400, max: 800 },
              sustain: { min: 0.7, max: 0.85 },
              release: { min: 2500, max: 5000 } // –î–ª–∏–Ω–Ω–µ–µ
            }
          },
          
          pad: {
            techniques: [
              { value: 'swell', weight: 0.5 },
              { value: 'sustained', weight: 0.4 },
              { value: 'shimmer', weight: 0.1 }
            ],
            register: {
              preferred: 'mid',
              range: { min: 48, max: 76 }
            },
            density: { min: 0.65, max: 0.8 },
            voices: { min: 3, max: 4 },     // –ú–µ–Ω—å—à–µ –≥–æ–ª–æ—Å–æ–≤
            velocity: { min: 45, max: 65 },
            
            effects: {
              chorus: { depth: 0.15, rate: 0.4 },
              reverb: { wet: 0.6, size: 0.95 }
            }
          },
          
          arpeggio: {
            techniques: [
              { value: 'slow_descend', weight: 0.6 }, // –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤–Ω–∏–∑
              { value: 'slow_ascend', weight: 0.3 },
              { value: 'random_sparse', weight: 0.1 }
            ],
            register: {
              preferred: 'mid-high',
              range: { min: 60, max: 84 }
            },
            density: { min: 0.35, max: 0.55 },
            velocity: { min: 40, max: 60 }
          },
          
          sparkles: {
            eventProbability: 0.15, // –ß–∞—â–µ, —á–µ–º —Ä–∞–Ω—å—à–µ (–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —É—Ö–æ–¥–∞ –º–µ–ª–æ–¥–∏–∏)
            velocity: { min: 30, max: 50 }
          },
          
          sfx: {
            density: { min: 0.5, max: 0.7 }, // –ë–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω—ã–µ
            velocity: { min: 30, max: 45 }
          }
        },
        
        bundles: [
          {
            id: 'RELEASE_BUNDLE_1',
            name: 'Softening',
            duration: { min: 16, max: 20 },
            
            characteristics: {
              harmonicMovement: 'gentle',
              densityBias: 0.0,
              filterCutoff: { min: 0.7, max: 0.85 },
              reverbWet: 0.65
            },
            
            phrases: {
              count: { min: 4, max: 5 },
              length: { min: 4, max: 4 }
            }
          },
          
          {
            id: 'RELEASE_BUNDLE_2',
            name: 'Settling',
            duration: { min: 16, max: 20 },
            
            characteristics: {
              harmonicMovement: 'returning',  // –í–æ–∑–≤—Ä–∞—Ç –∫ Dm7
              densityBias: -0.05,
              filterCutoff: { min: 0.6, max: 0.75 },
              reverbWet: 0.7
            },
            
            phrases: {
              count: { min: 4, max: 5 },
              length: { min: 4, max: 4 }
            }
          }
        ],
        
        outroFill: {
          type: 'density_pause',
          duration: 2,
          parameters: {
            soloLayer: 'pad',     // –í—Å–µ –º–æ–ª—á–∞—Ç –∫—Ä–æ–º–µ –ø–∞–¥–∞
            fadeOthers: 1.5       // –ó–∞—Ç—É—Ö–∞–Ω–∏–µ –¥—Ä—É–≥–∏—Ö –∑–∞ 1.5 —Ç–∞–∫—Ç–∞
          }
        }
      },
      
      // ========================================================================
      // –ß–ê–°–¢–¨ 5: OUTRO (–ó–∞—Ç—É—Ö–∞–Ω–∏–µ)
      // ========================================================================
      {
        id: 'OUTRO',
        name: 'Dissolution',
        
        duration: {
          bars: { min: 20, max: 32 },
          bundles: { min: 2, max: 2 }
        },
        
        layers: {
          bass: true,
          pad: false,             // –£–•–û–î–ò–¢!
          arpeggio: false,        // –£–•–û–î–ò–¢
          melody: false,
          sparkles: false,        // –£–•–û–î–Ø–¢
          sfx: true,              // –û—Å—Ç–∞—é—Ç—Å—è (—Ç–µ–∫—Å—Ç—É—Ä–∞)
          drums: false
        },
        
        instrumentExit: {
          arpeggio: 0.0,
          sparkles: 0.0,
          pad: 0.5,               // 50% OUTRO
          // Bass –∏ SFX –¥–æ –∫–æ–Ω—Ü–∞
        },
        
        instrumentRules: {
          bass: {
            techniques: [
              { value: 'drone', weight: 0.7 },      // –°—É–±-–±–∞—Å –¥—Ä–æ–Ω
              { value: 'pedal', weight: 0.3 }
            ],
            register: {
              preferred: 'sub',
              range: { min: 24, max: 40 } // C1-E2
            },
            density: { min: 0.3, max: 0.5 },
            velocity: { min: 45, max: 65 },
            
            envelope: {
              attack: { min: 1500, max: 3000 },
              decay: { min: 1000, max: 2000 },
              sustain: { min: 0.8, max: 0.95 },
              release: { min: 6000, max: 12000 } // –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π
            }
          },
          
          pad: {
            // –¢–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω—ã OUTRO
            techniques: [
              { value: 'sustained', weight: 0.7 },
              { value: 'shimmer', weight: 0.3 }
            ],
            density: { min: 0.4, max: 0.6 },
            velocity: { min: 35, max: 55 },
            
            effects: {
              reverb: { wet: 0.75, size: 1.0 }  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–≤–µ—Ä–±
            }
          },
          
          sfx: {
            techniques: [
              { value: 'air_texture', weight: 0.6 },
              { value: 'vinyl_crackle', weight: 0.4 }
            ],
            density: { min: 0.6, max: 0.8 }, // –ü–æ—á—Ç–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
            velocity: { min: 25, max: 40 }
          }
        },
        
        bundles: [
          {
            id: 'OUTRO_BUNDLE_1',
            name: 'Fading',
            duration: { min: 12, max: 16 },
            
            characteristics: {
              harmonicMovement: 'static',     // –¢–æ–ª—å–∫–æ Dm7
              densityBias: -0.15,
              filterCutoff: { min: 0.4, max: 0.6 },
              reverbWet: 0.75
            },
            
            phrases: {
              count: { min: 3, max: 4 },
              length: { min: 4, max: 4 }
            }
          },
          
          {
            id: 'OUTRO_BUNDLE_2',
            name: 'Silence',
            duration: { min: 8, max: 16 },
            
            characteristics: {
              harmonicMovement: 'none',
              densityBias: -0.25,             // –û—á–µ–Ω—å —Ä–∞–∑—Ä–µ–∂–µ–Ω–æ
              filterCutoff: { min: 0.3, max: 0.5 },
              reverbWet: 0.85
            },
            
            phrases: {
              count: { min: 2, max: 3 },
              length: { min: 4, max: 4 }
            },
            
            // –§–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞—Ç—É—Ö–∞–Ω–∏–µ
            finalFade: {
              type: 'exponential',
              duration: 8,          // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 8 —Ç–∞–∫—Ç–æ–≤
              targetVolume: 0.0     // –î–æ —Ç–∏—à–∏–Ω—ã
            }
          }
        ],
        
        outroFill: null // –ù–µ—Ç —Ñ–∏–ª–ª–∞ (–∫–æ–Ω–µ—Ü —Å—é–∏—Ç—ã)
      }
    ]
  },
  
  // ============================================================================
  // –ü–†–ê–í–ò–õ–ê –ú–£–¢–ê–¶–ò–ô
  // ============================================================================
  
  mutations: {
    onBundleBoundary: {
      probability: 0.4,         // 40% —à–∞–Ω—Å –º—É—Ç–∞—Ü–∏–∏ –º–µ–∂–¥—É –±–∞–Ω–¥–ª–∞–º–∏
      types: [
        { type: 'transpose', weight: 0.6, params: { semitones: [-2, 2, -5, 5] } },
        { type: 'rhythmic_shift', weight: 0.3, params: { shift: [0.125, 0.25] } },
        { type: 'velocity_curve', weight: 0.1, params: { curve: ['crescendo', 'diminuendo'] } }
      ]
    },
    
    onPartBoundary: {
      probability: 0.75,        // 75% —à–∞–Ω—Å –º–µ–∂–¥—É —á–∞—Å—Ç—è–º–∏
      types: [
        { type: 'inversion', weight: 0.3, params: {} },
        { type: 'register_shift', weight: 0.3, params: { octaves: [-1, 1] } },
        { type: 'voicing_change', weight: 0.2, params: { voicing: ['drop2', 'drop3', 'quartal'] } },
        { type: 'retrograde', weight: 0.1, params: {} },
        { type: 'augmentation', weight: 0.1, params: { factor: [1.5, 2.0] } }
      ]
    },
    
    onSuiteBoundary: {
      // –ü–æ–ª–Ω–∞—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
      regenerateAxioms: true,
      varyHarmonicCenter: {
        enabled: true,
        allowedRoots: ['D', 'A', 'G'], // –ë–ª–∏–∑–∫–∏–µ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
        allowedScales: ['dorian', 'aeolian']
      },
      reshuffleLayering: false  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–ª–æ—ë–≤
    }
  },
  
  // ============================================================================
  // AMBIENT EVENTS (—Å–ª—É—á–∞–π–Ω—ã–µ –º–∏–∫—Ä–æ-—Å–æ–±—ã—Ç–∏—è)
  // ============================================================================
  
  ambientEvents: [
    {
      type: 'bell',
      probability: 0.06,        // 6% –∫–∞–∂–¥—ã–π —Ç–∞–∫—Ç
      timingVariance: 0.4,      // ¬±40% –æ—Ç –¥–æ–ª–∏
      pitchRange: { min: 84, max: 96 }, // C6-C7
      velocityRange: { min: 25, max: 45 },
      effects: {
        reverb: { wet: 0.8, size: 0.95 },
        delay: { time: 0.375, feedback: 0.25, wet: 0.5 }
      },
      activeParts: ['BUILD', 'MAIN', 'RELEASE'] // –ù–µ –≤ INTRO/OUTRO
    },
    
    {
      type: 'pad_swell',
      probability: 0.03,
      timingVariance: 0.0,
      duration: { min: 4, max: 8 }, // –¢–∞–∫—Ç–æ–≤
      velocityRange: { min: 35, max: 55 },
      effects: {
        reverb: { wet: 0.7, size: 1.0 }
      },
      activeParts: ['INTRO', 'BUILD', 'MAIN', 'RELEASE']
    },
    
    {
      type: 'granular_freeze',
      probability: 0.02,
      duration: { min: 2, max: 4 },
      source: 'pad',            // –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –ø–∞–¥
      grainSize: 150,           // –º—Å
      pitchShift: { min: -7, max: 5 }, // –ü–æ–ª—É—Ç–æ–Ω–∞
      activeParts: ['MAIN', 'RELEASE']
    },
    
    {
      type: 'reverse_cymbal',
      probability: 0.04,
      timingVariance: 0.2,
      velocityRange: { min: 30, max: 50 },
      activeParts: ['BUILD', 'MAIN']
    }
  ],
  
  // ============================================================================
  // CONTINUITY POLICY (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å—é)
  // ============================================================================
  
  continuity: {
    anchorLayers: ['bass', 'pad'], // –•–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤—Å–µ–≥–¥–∞ –∑–≤—É—á–∏—Ç
    
    bass: {
      minDensity: 0.5,          // 50% –≤—Ä–µ–º–µ–Ω–∏ –º–∏–Ω–∏–º—É–º
      maxGapDuration: 6,        // –ü–∞—É–∑–∞ –Ω–µ –¥–æ–ª—å—à–µ 6 —Ç–∞–∫—Ç–æ–≤
      exceptions: {
        OUTRO: { maxGapDuration: 12 } // –í OUTRO –º–æ–∂–Ω–æ –¥–æ–ª—å—à–µ
      }
    },
    
    pad: {
      minDensity: 0.6,
      maxGapDuration: 4,
      exceptions: {
        OUTRO: { minDensity: 0.3 } // –í OUTRO —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–µ–µ
      }
    },
    
    // –ü—Ä–∞–≤–∏–ª–æ: –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–æ–ª—á–∞—Ç –æ–±–∞ —è–∫–æ—Ä—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
    simultaneousSilence: {
      allowed: false,
      fallback: 'bass'          // –ï—Å–ª–∏ –æ–±–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–º–æ–ª—á–∞—Ç—å ‚Üí –±–∞—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç
    }
  },
  
  // ============================================================================
  // –ú–ï–¢–ê–î–ê–ù–ù–´–ï –î–õ–Ø –†–ï–ù–î–ï–†–ò–ù–ì–ê
  // ============================================================================
  
  rendering: {
    sampleRate: 48000,
    bitDepth: 24,
    masterVolume: -16,          // LUFS integrated
    truepeakLimit: -1.0,        // dBTP
    
    mixTargets: {
      bass: { level: -18, pan: 0.0 },
      pad: { level: -16, pan: 0.0 },
      arpeggio: { level: -20, pan: 0.15 },
      melody: { level: -18, pan: -0.1 },
      sparkles: { level: -26, pan: 0.3 },
      sfx: { level: -32, pan: 0.0 },
      drums: { level: -22, pan: 0.0 }
    }
  }
};
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–ª—é–ø—Ä–∏–Ω—Ç–∞

```typescript
// src/lib/fractal-music-engine.ts

export class FractalMusicEngine {
  constructor(config: { blueprint: MusicBlueprint; mood: MoodName; seed: number }) {
    this.blueprint = config.blueprint;
    this.seed = config.seed;
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª —Å seed
    this.rng = new SeededRandom(this.seed);
  }
  
  initialize() {
    // 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—é–∏—Ç—ã (–∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞)
    this.totalBars = this.rng.intBetween(
      this.blueprint.structure.totalDuration.bars.min,
      this.blueprint.structure.totalDuration.bars.max
    );
    
    // 2. –î–ª—è –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–Ω–¥–ª–æ–≤
    this.parts = this.blueprint.structure.parts.map(partSpec => {
      const bars = this.rng.intBetween(partSpec.duration.bars.min, partSpec.duration.bars.max);
      const bundleCount = this.rng.intBetween(partSpec.duration.bundles.min, partSpec.duration.bundles.max);
      
      return {
        ...partSpec,
        actualBars: bars,
        actualBundles: bundleCount
      };
    });
    
    // 3. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Å–∏–æ–º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∏ —á–∞—Å—Ç–∏
    this.generateAxioms();
    
    // 4. –°–æ–∑–¥–∞—Ç—å "–ü–ª–∞–Ω –ò–≥—Ä—ã" (Play Plan)
    this.createPlayPlan();
  }
  
  private generateAxioms() {
    // –î–ª—è –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–±–æ—Ä –∞–∫—Å–∏–æ–º
    for (const part of this.parts) {
      const bassRules = part.instrumentRules.bass;
      
      // –í—ã–±–∏—Ä–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ)
      const technique = this.rng.weightedChoice(bassRules.techniques);
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ñ—Ä–∞–∑—É
      const phrase = generateAmbientBassPhrase(
        this.blueprint.mood,
        this.blueprint.musical.key,
        technique.value,
        4, // –¥–ª–∏–Ω–∞ —Ñ—Ä–∞–∑—ã
        bassRules.register.range,
        bassRules.density,
        bassRules.velocity,
        bassRules.envelope
      );
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º
      this.axioms.bass[part.id] = phrase;
    }
    
    // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è pad, arpeggio, etc.
  }
  
  private createPlayPlan() {
    // –°–æ–∑–¥–∞—ë–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –∫–∞–∫—É—é —Ñ—Ä–∞–∑—É –∫–æ–≥–¥–∞ –∏–≥—Ä–∞—Ç—å
    // –° —É—á—ë—Ç–æ–º –º—É—Ç–∞—Ü–∏–π –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –±–∞–Ω–¥–ª–æ–≤/—á–∞—Å—Ç–µ–π
  }
  
  evolve(): FractalEvent[] {
    // –ö–∞–∂–¥—ã–π —Ç–∞–∫—Ç:
    // 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é —á–∞—Å—Ç—å/–±–∞–Ω–¥–ª
    // 2. –í–∑—è—Ç—å —Ñ—Ä–∞–∑—É –∏–∑ Play Plan
    // 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º—É—Ç–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ)
    // 4. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ambient events (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ)
    // 5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å tension modulation
    // 6. –í–µ—Ä–Ω—É—Ç—å —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
  }
}
```

---

## –ß—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å?

**–≠—Ç–æ—Ç –±–ª—é–ø—Ä–∏–Ω—Ç:**
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å—ã–≤–∞–µ—Ç 12-–º–∏–Ω—É—Ç–Ω—É—é –º–µ–ª–∞–Ω—Ö–æ–ª–∏—á–Ω—É—é —Å—é–∏—Ç—É
- ‚úÖ –ó–∞–¥–∞—ë—Ç **–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**, –Ω–æ –Ω–µ –∂—ë—Å—Ç–∫–∏–π —Å–∫—Ä–∏–ø—Ç (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, –¥–∏–∞–ø–∞–∑–æ–Ω—ã)
- ‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã (–∏–µ—Ä–∞—Ä—Ö–∏—è, –º—É—Ç–∞—Ü–∏–∏, —Ñ–∏–ª–ª—ã, –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å)
- ‚úÖ –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ (–≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã)

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –°–æ–∑–¥–∞—Ç—å —É–ø—Ä–æ—â—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ —Å—Ä–∞–∑—É –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 7 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π?
